(window.webpackJsonp=window.webpackJsonp||[]).push([[184],{513:function(a,t,s){"use strict";s.r(t);var r=s(7),e=Object(r.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("p",[t("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/tree/master/yudao-framework/yudao-spring-boot-starter-biz-ip",target:"_blank",rel:"noopener noreferrer"}},[t("code",[a._v("yudao-spring-boot-starter-biz-ip")]),t("OutboundLink")],1),a._v(" 业务组件，提供地区 & IP 库的封装。")]),a._v(" "),t("h2",{attrs:{id:"_1-地区"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-地区"}},[a._v("#")]),a._v(" 1. 地区")]),a._v(" "),t("p",[t("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-framework/yudao-spring-boot-starter-biz-ip/src/main/java/cn/iocoder/yudao/framework/ip/core/utils/AreaUtils.java",target:"_blank",rel:"noopener noreferrer"}},[a._v("AreaUtils"),t("OutboundLink")],1),a._v(" 是地区工具类，可以查询中国的省、市、区县，也可以查询国外的国家。")]),a._v(" "),t("p",[a._v("它的数据来自 "),t("a",{attrs:{href:"https://github.com/modood/Administrative-divisions-of-China",target:"_blank",rel:"noopener noreferrer"}},[a._v("Administrative-divisions-of-China"),t("OutboundLink")],1),a._v(" 项目，最终整理到项目的 "),t("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-framework/yudao-spring-boot-starter-biz-ip/src/main/resources/area.csv",target:"_blank",rel:"noopener noreferrer"}},[a._v("area.csv"),t("OutboundLink")],1),a._v(" 文件。每一行的数据，对应 "),t("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-framework/yudao-spring-boot-starter-biz-ip/src/main/java/cn/iocoder/yudao/framework/ip/core/Area.java",target:"_blank",rel:"noopener noreferrer"}},[a._v("Area"),t("OutboundLink")],1),a._v(" 对象。代码所示：")]),a._v(" "),t("div",{staticClass:"language-Java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Area")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/**\n     * 编号\n     */")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Integer")]),a._v(" id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/**\n     * 名字\n     */")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("String")]),a._v(" name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/**\n     * 类型\n     *\n     * 枚举 {@link AreaTypeEnum}\n     * 1 - 国家\n     * 2 - 省份\n     * 3 - 城市\n     * 4 - 地区, 例如说县、镇、区等\n     */")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Integer")]),a._v(" type"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/**\n     * 父节点\n     */")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Area")]),a._v(" parent"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/**\n     * 子节点\n     */")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("List")]),t("span",{pre:!0,attrs:{class:"token generics"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Area")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v(" children"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    \n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),t("p",[a._v("AreaUtils 主要有如下两个方法：")]),a._v(" "),t("div",{staticClass:"language-Java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// AreaUtils.java")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/**\n * 获得指定编号对应的区域\n *\n * @param id 区域编号\n * @return 区域\n */")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Area")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("getArea")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Integer")]),a._v(" id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// ... 省略具体实现")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/**\n * 格式化区域\n *\n * 例如说：\n *      1. id = “静安区”时：上海 上海市 静安区\n *      2. id = “上海市”时：上海 上海市\n *      3. id = “上海”时：上海\n *      4. id = “美国”时：美国\n * 当区域在中国时，默认不显示中国\n *\n * @param id 区域编号\n * @param separator 分隔符\n * @return 格式化后的区域\n */")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("String")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("format")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Integer")]),a._v(" id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("String")]),a._v(" separator"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// ... 省略具体实现")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),t("ul",[t("li",[a._v("具体的使用，可见 "),t("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-framework/yudao-spring-boot-starter-biz-ip/src/test/java/cn/iocoder/yudao/framework/ip/core/utils/AreaUtilsTest.java",target:"_blank",rel:"noopener noreferrer"}},[a._v("AreaUtilsTest"),t("OutboundLink")],1),a._v(" 测试类。")])]),a._v(" "),t("p",[a._v("另外，管理后台提供了 [系统管理 -> 地区管理] 菜单，可以按照树形结构查看地区列表。如下图所示：")]),a._v(" "),t("p",[t("img",{attrs:{src:"/img/%E5%9C%B0%E5%8C%BA%E4%B8%8EIP/%E5%9C%B0%E5%8C%BA%E7%AE%A1%E7%90%86.png",alt:"地区管理"}})]),a._v(" "),t("ul",[t("li",[a._v("后端代码，对应 "),t("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-system/yudao-module-system-biz/src/main/java/cn/iocoder/yudao/module/system/controller/admin/ip/AreaController.java#L29-L35",target:"_blank",rel:"noopener noreferrer"}},[a._v("AreaController"),t("OutboundLink")],1),a._v(" 的 "),t("code",[a._v("/admin-api/system/area/tree")]),a._v(" 接口")]),a._v(" "),t("li",[a._v("前端代码，对应 "),t("a",{attrs:{href:"https://github.com/yudaocode/yudao-ui-admin-vue2/blob/master/src/views/system/area/index.vue",target:"_blank",rel:"noopener noreferrer"}},[a._v("system/area/index.vue"),t("OutboundLink")],1),a._v(" 界面")])]),a._v(" "),t("h2",{attrs:{id:"_2-ip"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-ip"}},[a._v("#")]),a._v(" 2. IP")]),a._v(" "),t("p",[t("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-framework/yudao-spring-boot-starter-biz-ip/src/main/java/cn/iocoder/yudao/framework/ip/core/utils/IPUtils.java",target:"_blank",rel:"noopener noreferrer"}},[a._v("IPUtils"),t("OutboundLink")],1),a._v(" 是 IP 工具类，可以查询 IP 对应的城市信息。")]),a._v(" "),t("p",[a._v("它的数据来自 "),t("a",{attrs:{href:"https://gitee.com/lionsoul/ip2region",target:"_blank",rel:"noopener noreferrer"}},[a._v("ip2region"),t("OutboundLink")],1),a._v(" 项目，最终整理到项目的 "),t("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-framework/yudao-spring-boot-starter-biz-ip/src/main/resources/ip2region.xdb",target:"_blank",rel:"noopener noreferrer"}},[a._v("ip2region.xdb"),t("OutboundLink")],1),a._v(" 文件。")]),a._v(" "),t("p",[a._v("IPUtils 主要有如下两个方法：")]),a._v(" "),t("div",{staticClass:"language-Java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// IPUtils.java")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/**\n * 查询 IP 对应的地区编号\n *\n * @param ip IP 地址，格式为 127.0.0.1\n * @return 地区id\n */")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Integer")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("getAreaId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("String")]),a._v(" ip"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// ... 省略具体实现")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/**\n * 查询 IP 对应的地区\n *\n * @param ip IP 地址，格式为 127.0.0.1\n * @return 地区\n */")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Area")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("getArea")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("String")]),a._v(" ip"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// ... 省略具体实现")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),t("ul",[t("li",[a._v("具体的使用，可见 "),t("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-framework/yudao-spring-boot-starter-biz-ip/src/test/java/cn/iocoder/yudao/framework/ip/core/utils/IPUtilsTest.java",target:"_blank",rel:"noopener noreferrer"}},[a._v("IPUtilsTest"),t("OutboundLink")],1),a._v(" 测试类。")])]),a._v(" "),t("p",[a._v("另外，管理后台提供了 [系统管理 -> 地区管理] 菜单，也提供了 IP 查询城市的示例。如下图所示：")]),a._v(" "),t("p",[t("img",{attrs:{src:"/img/%E5%9C%B0%E5%8C%BA%E4%B8%8EIP/IP%E6%9F%A5%E8%AF%A2%E5%9F%8E%E5%B8%82.png",alt:"IP 查询城市"}})]),a._v(" "),t("ul",[t("li",[a._v("后端代码，对应 "),t("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-system/yudao-module-system-biz/src/main/java/cn/iocoder/yudao/module/system/controller/admin/ip/AreaController.java#L37-L48",target:"_blank",rel:"noopener noreferrer"}},[a._v("AreaController"),t("OutboundLink")],1),a._v(" 的 "),t("code",[a._v("/admin-api/system/area/get-by-ip")]),a._v(" 接口")])])])}),[],!1,null,null,null);t.default=e.exports}}]);