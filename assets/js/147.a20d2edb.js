(window.webpackJsonp=window.webpackJsonp||[]).push([[147],{476:function(t,s,a){"use strict";a.r(s);var n=a(7),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("AI 工具，基于 LLM 模型的 function calling 机制，实现模型对我们系统内部的功能调用。")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("疑问：什么是 function calling？")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/637002733",target:"_blank",rel:"noopener noreferrer"}},[t._v("《OpenAI 的新能力 —— Function Calling》"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://help.aliyun.com/zh/model-studio/user-guide/qwen-function-calling",target:"_blank",rel:"noopener noreferrer"}},[t._v("《阿里云 Function Calling》"),s("OutboundLink")],1)])])]),t._v(" "),s("p",[t._v("目前，项目中的 "),s("RouterLink",{attrs:{to:"/ai/chat/"}},[t._v("AI 聊天对话")]),t._v(" 功能，已经接入 AI 工具，如下图所示：")],1),t._v(" "),s("p",[s("img",{attrs:{src:"/img/AI%E6%89%8B%E5%86%8C/AI%E5%B7%A5%E5%85%B7/AI%E5%B7%A5%E5%85%B7%E7%9A%84%E6%A1%88%E4%BE%8B.png",alt:"AI 工具的案例"}})]),t._v(" "),s("p",[t._v("整个功能，涉及到 1 个表：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("ai_tool")]),t._v("：AI 工具表")])]),t._v(" "),s("p",[t._v("下面，我们逐个表进行介绍，这个过程中也会讲讲对应的功能。")]),t._v(" "),s("h2",{attrs:{id:"_1-ai-工具表"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-ai-工具表"}},[t._v("#")]),t._v(" 1. AI 工具表")]),t._v(" "),s("p",[s("code",[t._v("ai_tool")]),t._v(" 表，用于存储 AI 工具的配置信息。")]),t._v(" "),s("h3",{attrs:{id:"_1-1-表结构"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-表结构"}},[t._v("#")]),t._v(" 1.1 表结构")]),t._v(" "),s("blockquote",[s("p",[t._v("省略 creator/create_time/updater/update_time/deleted/tenant_id 等通用字段")])]),t._v(" "),s("div",{staticClass:"language-SQL extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("ai_tool"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bigint")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AUTO_INCREMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'工具编号'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  \n  "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("128")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHARACTER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" utf8mb4 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLLATE")]),t._v(" utf8mb4_unicode_ci "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'工具名称'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  \n  "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("description"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("256")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHARACTER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" utf8mb4 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLLATE")]),t._v(" utf8mb4_unicode_ci "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'工具描述'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  \n  "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("status"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("tinyint")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'状态'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PRIMARY")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("KEY")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("USING")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BTREE")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENGINE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("InnoDB")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AUTO_INCREMENT")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHARSET")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("utf8mb4 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLLATE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("utf8mb4_unicode_ci "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'AI 工具表'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("只有 "),s("code",[t._v("name")]),t._v(" 字段，是关键字段。它对应项目中的 AI 工具类的 Spring Bean 名字。例如说：")]),t._v(" "),s("ul",[s("li",[t._v("WeatherQueryToolFunction 类：查询指定城市的天气信息，对应 "),s("code",[t._v("weather_query")])]),t._v(" "),s("li",[t._v("DirectoryListToolFunction 类：列出指定目录的文件列表，对应 "),s("code",[t._v("directory_list")])])]),t._v(" "),s("p",[t._v("具体 AI 工具类的编写方式，可以看看上面两个类。当然，更多也可以看看 Spring AI 的如下文档：")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://docs.spring.io/spring-ai/reference/api/chat/functions/openai-chat-functions.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("《Function Calling》"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://docs.spring.io/spring-ai/reference/api/tools.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("《Tool Calling》"),s("OutboundLink")],1)])]),t._v(" "),s("h3",{attrs:{id:"_1-2-管理后台"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-管理后台"}},[t._v("#")]),t._v(" 1.2 管理后台")]),t._v(" "),s("p",[t._v("前端对应 [AI 大模型 -> 控制台 -> AI 工具管理] 菜单，对应 "),s("code",[t._v("yudao-ui-admin-vue3")]),t._v(" 项目的 "),s("code",[t._v("@/views/ai/model/tool")]),t._v(" 目录，提供给管理员使用，创建工具。")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/AI%E6%89%8B%E5%86%8C/AI%E5%B7%A5%E5%85%B7/%E5%B7%A5%E5%85%B7%E7%AE%A1%E7%90%86.png",alt:"AI 工具"}})]),t._v(" "),s("p",[t._v("它的后端 HTTP 接口，由 "),s("code",[t._v("yudao-module-ai")]),t._v(" 模块的 "),s("code",[t._v("model")]),t._v(" 包的 AiToolController 实现。")]),t._v(" "),s("h2",{attrs:{id:"_2-如何使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-如何使用"}},[t._v("#")]),t._v(" 2. 如何使用？")]),t._v(" "),s("p",[t._v("① 第一步，在角色配置时，关联对应的 AI 工具，可多选。如下图所示：")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/AI%E6%89%8B%E5%86%8C/AI%E5%B7%A5%E5%85%B7/%E5%B7%A5%E5%85%B7%E8%A7%92%E8%89%B2%E9%85%8D%E7%BD%AE.png",alt:"AI 工具角色配置"}})]),t._v(" "),s("p",[t._v("② 第二步，使用该角色进行聊天，即可使用 AI 工具。如下图所示：")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/AI%E6%89%8B%E5%86%8C/AI%E5%B7%A5%E5%85%B7/AI%E5%B7%A5%E5%85%B7%E7%9A%84%E6%A1%88%E4%BE%8B.png",alt:"AI 工具的案例"}})]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("疑问：哪些模型支持 function calling 机制？")]),t._v(" "),s("p",[t._v("目前项目中的绝大多数模型，都已经支持。如下是我暂时【没】测试通过的模型平台：")]),t._v(" "),s("ul",[s("li",[t._v("SILICON_FLOW 硅基流动（忘记原因了。。。）")]),t._v(" "),s("li",[t._v("XING_HUO 星火讯飞（没有返回 Tool 的 ResponseID）")]),t._v(" "),s("li",[t._v("YI_YAN 文心一言（API KEY 不通过）")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);