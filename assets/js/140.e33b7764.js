(window.webpackJsonp=window.webpackJsonp||[]).push([[140],{469:function(t,a,s){"use strict";s.r(a);var e=s(7),r=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("进度说明：")]),t._v(" "),a("ul",[a("li",[t._v("管理后台，请使用 "),a("a",{attrs:{href:"https://gitee.com/yudaocode/yudao-ui-admin-vue3",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://gitee.com/yudaocode/yudao-ui-admin-vue3"),a("OutboundLink")],1),t._v(" 仓库的 "),a("code",[t._v("master")]),t._v(" 分支")]),t._v(" "),a("li",[t._v("后端项目，请使用 "),a("a",{attrs:{href:"https://gitee.com/zhijiantianya/ruoyi-vue-pro",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://gitee.com/zhijiantianya/ruoyi-vue-pro"),a("OutboundLink")],1),t._v(" 仓库的 "),a("code",[t._v("master-jdk17")]),t._v(" 分支")])]),t._v(" "),a("p",[t._v("注意！仅支持 JDK 17/21 使用，因为基于 "),a("a",{attrs:{href:"https://spring.io/projects/spring-ai",target:"_blank",rel:"noopener noreferrer"}},[t._v("Spring AI"),a("OutboundLink")],1),t._v(" 实现，它基于 Spring Boot 3.X 构建，所以最低要求 JDK 17！！！")])]),t._v(" "),a("p",[t._v("AI 系统，后端由 "),a("code",[t._v("yudao-module-ai")]),t._v(" 模块实现，前端由 "),a("code",[t._v("yudao-ui-admin-vue3")]),t._v(" 的 "),a("code",[t._v("ai")]),t._v(" 目录实现。")]),t._v(" "),a("p",[t._v("考虑到编译速度，默认 "),a("code",[t._v("yudao-module-ai")]),t._v(" 模块是关闭的，需要手动开启。步骤如下：")]),t._v(" "),a("ul",[a("li",[t._v("第一步，开启 "),a("code",[t._v("yudao-module-ai")]),t._v(" 模块")]),t._v(" "),a("li",[t._v("第二步，导入 AI 系统的 SQL 数据库脚本")]),t._v(" "),a("li",[t._v("第三步，重启后端项目，确认功能是否生效")])]),t._v(" "),a("h2",{attrs:{id:"_1-第一步-开启模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-第一步-开启模块"}},[t._v("#")]),t._v(" 1. 第一步，开启模块")]),t._v(" "),a("p",[t._v("① 修改根目录的 "),a("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/pom.xml",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("pom.xml")]),a("OutboundLink")],1),t._v(" 文件，取消 "),a("code",[t._v("yudao-module-ai")]),t._v(" 模块的注释。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/AI%E6%89%8B%E5%86%8C/%E5%8A%9F%E8%83%BD%E5%BC%80%E5%90%AF/%E7%AC%AC%E4%B8%80%E6%AD%A5-01.png",alt:"取消  模块的注释"}})]),t._v(" "),a("p",[t._v("② 修改 "),a("code",[t._v("yudao-server")]),t._v(" 目录的 "),a("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-server/pom.xml",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("pom.xml")]),a("OutboundLink")],1),t._v(" 文件，引入 "),a("code",[t._v("yudao-module-ai")]),t._v(" 模块。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/AI%E6%89%8B%E5%86%8C/%E5%8A%9F%E8%83%BD%E5%BC%80%E5%90%AF/%E7%AC%AC%E4%B8%80%E6%AD%A5-02.png",alt:"引入  模块"}})]),t._v(" "),a("p",[t._v("③ 点击 IDEA 右上角的【Reload All Maven Projects】，刷新 Maven 依赖。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E5%85%AC%E4%BC%97%E5%8F%B7%E6%89%8B%E5%86%8C/%E5%8A%9F%E8%83%BD%E5%BC%80%E5%90%AF/%E7%AC%AC%E4%B8%80%E6%AD%A5-03.png",alt:"刷新 Maven 依赖"}})]),t._v(" "),a("h2",{attrs:{id:"_2-第二步-导入-sql"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-第二步-导入-sql"}},[t._v("#")]),t._v(" 2. 第二步，导入 SQL")]),t._v(" "),a("p",[t._v("点击 "),a("a",{attrs:{href:"https://t.zsxq.com/09F92",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("ai-2024-07-07.sql.zip")]),a("OutboundLink")],1),t._v(" 下载附件，解压出 SQL 文件，然后导入到数据库中。")]),t._v(" "),a("p",[t._v("所以表名字，都使用 "),a("code",[t._v("ai_")]),t._v(" 作为前缀。")]),t._v(" "),a("h2",{attrs:{id:"_3-第三步-重启项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-第三步-重启项目"}},[t._v("#")]),t._v(" 3. 第三步，重启项目")]),t._v(" "),a("p",[t._v("重启后端项目，然后访问前端的 AI 菜单，确认功能是否生效。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/AI%E6%89%8B%E5%86%8C/%E5%8A%9F%E8%83%BD%E6%BC%94%E7%A4%BA/%E7%AE%A1%E7%90%86%E5%90%8E%E5%8F%B0.png",alt:"确认功能是否生效"}})]),t._v(" "),a("p",[t._v("至此，我们就成功开启了 AI 的功能 🙂")]),t._v(" "),a("p",[t._v("可以访问 [AI 大模型 -> AI 对话] 菜单，点击左上角的【新建对话】按钮后，确认右上角的模型是“deepseek”后，就可以和 AI 大模型聊起来了！")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("友情提示：")]),t._v(" "),a("p",[t._v("如果聊天报错，可能是 API 密钥配置不正确，或者 API 密钥欠费了，可以参考下面的「666. 使用必读」小节，配置你自己申请的密钥。")])]),t._v(" "),a("h2",{attrs:{id:"_4-使用必读"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-使用必读"}},[t._v("#")]),t._v(" 4. 使用必读！！！")]),t._v(" "),a("p",[t._v("目前 AI 系统下的功能，是基于 "),a("a",{attrs:{href:"https://www.redhat.com/zh/topics/ai/what-are-large-language-models",target:"_blank",rel:"noopener noreferrer"}},[t._v("LLM 大模型"),a("OutboundLink")],1),t._v("，从而实现对话、绘图等一系列功能。")]),t._v(" "),a("p",[t._v("使用时，需要进行 API 密钥、模型的配置。下面，我们来了解下。")]),t._v(" "),a("h3",{attrs:{id:"_4-1-api-秘钥表"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-api-秘钥表"}},[t._v("#")]),t._v(" 4.1 API 秘钥表")]),t._v(" "),a("p",[a("code",[t._v("ai_api_key")]),t._v("：API 秘钥表，顾名思义，就是存储 AI 大模型的 API 密钥的表。")]),t._v(" "),a("h4",{attrs:{id:"_4-1-1-表结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-1-表结构"}},[t._v("#")]),t._v(" 4.1.1 表结构")]),t._v(" "),a("blockquote",[a("p",[t._v("省略 creator/create_time/updater/update_time/deleted/tenant_id 等通用字段")])]),t._v(" "),a("div",{staticClass:"language-SQL extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("ai_api_key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bigint")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AUTO_INCREMENT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'编号'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("255")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLLATE")]),t._v(" utf8mb4_unicode_ci "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'名称'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("platform"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("255")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLLATE")]),t._v(" utf8mb4_unicode_ci "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'平台'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("api_key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("255")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHARACTER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" utf8mb4 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLLATE")]),t._v(" utf8mb4_unicode_ci "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'密钥'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("255")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHARACTER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" utf8mb4 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLLATE")]),t._v(" utf8mb4_unicode_ci "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'自定义 API 地址'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("status"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'状态'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PRIMARY")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("KEY")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENGINE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("InnoDB")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AUTO_INCREMENT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHARSET")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("utf8mb4 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLLATE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("utf8mb4_unicode_ci "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'AI API 密钥表'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("① "),a("code",[t._v("platform")]),t._v(" 字段：表示平台，对应 AiPlatformEnum 枚举，目前支持多个 AI 大模型：")]),t._v(" "),a("ul",[a("li",[t._v("国内：【阿里】通义千问、【深度求索】DeepSeek、【字节】豆包、【腾讯】混元、【百度】文心一言、【SiliconFlow】硅基流动、【讯飞】星火、【智谱】GLM")]),t._v(" "),a("li",[t._v("国外：【OpenAI】GPT、【Meta】Llama、【Google】Gemini、【Stability】Stable Diffusion")])]),t._v(" "),a("p",[t._v("通过 "),a("code",[t._v("platform")]),t._v(" 字段，可以区分不同的平台，从而创建对应的 Spring AI Model 对象，调用对应的平台，具体可见 AiModelFactoryImpl 类下的一系列方法。")]),t._v(" "),a("p",[t._v("② "),a("code",[t._v("api_key")]),t._v(" 字段：表示 API 密钥，对应不同的平台的密钥，例如说 OpenAI 的 API KEY。但是要注意，有些平台是多个值，例如说文心一言是 "),a("code",[t._v("appKey")]),t._v(" + "),a("code",[t._v("secretKey")]),t._v(" 组合，那它在 "),a("code",[t._v("api_key")]),t._v(" 就是 "),a("code",[t._v("${appKey}|${secretKey}")]),t._v("。")]),t._v(" "),a("p",[a("code",[t._v("url")]),t._v(" 字段：表示自定义 API 地址。一般情况下不需要配置，除非你有自定义的需求，例如说 OpenAI 使用 API 中转。")]),t._v(" "),a("p",[t._v("具体它们怎么配置，或者怎么部署，可见对应的文档：")]),t._v(" "),a("ul",[a("li",[t._v("国内模型："),a("a",{attrs:{href:"/ai/tongyi"}},[t._v("《通义千问》")]),t._v("、"),a("a",{attrs:{href:"/ai/deep-seek"}},[t._v("《DeepSeek》")]),t._v("、"),a("a",{attrs:{href:"/ai/doubao"}},[t._v("《豆包》")]),t._v("、"),a("a",{attrs:{href:"/ai/hunyuan"}},[t._v("《混元》")]),t._v("、"),a("a",{attrs:{href:"/ai/yiyan"}},[t._v("《文心一言》")]),t._v("、"),a("a",{attrs:{href:"/ai/siliconflow"}},[t._v("《硅基流动》")]),t._v("、"),a("a",{attrs:{href:"/ai/xinghuo"}},[t._v("《讯飞星火》")]),t._v("、"),a("a",{attrs:{href:"/ai/glm"}},[t._v("《智谱 GLM》")]),t._v("、"),a("a",{attrs:{href:"/ai/moonshot"}},[t._v("《月之暗灭》")]),t._v("、"),a("a",{attrs:{href:"/ai/minimax"}},[t._v("《MiniMax》")]),t._v("、"),a("a",{attrs:{href:"/ai/baichuan"}},[t._v("《百川智能》")])]),t._v(" "),a("li",[t._v("国外模型："),a("a",{attrs:{href:"/ai/openai"}},[t._v("《OpenAI（ChatGPT）》")]),t._v("、"),a("a",{attrs:{href:"/ai/llama"}},[t._v("《LLAMA》")]),t._v("、"),a("a",{attrs:{href:"/ai/azure-openai"}},[t._v("《微软 OpenAI（ChatGPT）》")]),t._v("、"),a("a",{attrs:{href:"/ai/gemini"}},[t._v("《谷歌 Gemini》")])])]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("友情提示：")]),t._v(" "),a("p",[t._v("一般情况下，建议先使用 "),a("a",{attrs:{href:"/ai/deep-seek"}},[t._v("《DeepSeek》")]),t._v(" 模型，因为免费送了一些 tokens，可以先体验一下。")])]),t._v(" "),a("h4",{attrs:{id:"_4-1-2-管理后台"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-2-管理后台"}},[t._v("#")]),t._v(" 4.1.2 管理后台")]),t._v(" "),a("p",[t._v("前端对应 [AI 大模型 -> 控制台 -> API 密钥] 菜单，对应 "),a("code",[t._v("yudao-ui-admin-vue3")]),t._v(" 项目的 "),a("code",[t._v("@/views/ai/model/apiKey")]),t._v(" 目录。")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/AI%E6%89%8B%E5%86%8C/AI%E9%85%8D%E7%BD%AE/API%E5%AF%86%E9%92%A5.png",alt:"API 密钥"}})]),t._v(" "),a("p",[t._v("它的后端 HTTP 接口，由 "),a("code",[t._v("yudao-module-ai")]),t._v(" 模块的 "),a("code",[t._v("model")]),t._v(" 包的 AiApiKeyController 实现。")]),t._v(" "),a("h3",{attrs:{id:"_4-2-模型表"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-模型表"}},[t._v("#")]),t._v(" 4.2 模型表")]),t._v(" "),a("p",[a("code",[t._v("ai_model")]),t._v("：模型表，配置每个平台下有哪些可用的模型。")]),t._v(" "),a("h4",{attrs:{id:"_4-2-1-表结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-1-表结构"}},[t._v("#")]),t._v(" 4.2.1 表结构")]),t._v(" "),a("blockquote",[a("p",[t._v("省略 creator/create_time/updater/update_time/deleted/tenant_id 等通用字段")])]),t._v(" "),a("div",{staticClass:"language-SQL extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("ai_model"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bigint")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AUTO_INCREMENT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'编号'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHARACTER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" utf8mb4 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLLATE")]),t._v(" utf8mb4_unicode_ci "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'模型名字'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("sort"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'排序'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("status"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("tinyint")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'状态'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  \n  "),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("key_id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bigint")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'API 秘钥编号'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("platform"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("32")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHARACTER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" utf8mb4 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLLATE")]),t._v(" utf8mb4_unicode_ci "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'模型平台'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("model"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHARACTER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" utf8mb4 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLLATE")]),t._v(" utf8mb4_unicode_ci "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'模型标识'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("temperature"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("double")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'温度参数'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("max_tokens"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'单条回复的最大 Token 数量'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("max_contexts"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'上下文的最大 Message 数量'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PRIMARY")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("KEY")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENGINE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("InnoDB")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AUTO_INCREMENT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHARSET")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("utf8mb4 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLLATE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("utf8mb4_unicode_ci "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'AI 模型表'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("① "),a("code",[t._v("key_id")]),t._v(" 字段：表示 API 秘钥编号，对应 "),a("code",[t._v("ai_api_key")]),t._v(" 表的 "),a("code",[t._v("id")]),t._v(" 字段。")]),t._v(" "),a("p",[a("code",[t._v("platform")]),t._v(" 字段：表示模型平台，冗余 "),a("code",[t._v("ai_api_key")]),t._v(" 表的 "),a("code",[t._v("platform")]),t._v(" 字段。")]),t._v(" "),a("p",[t._v("② "),a("code",[t._v("model")]),t._v(" 字段：表示模型标识，对应不同的平台的模型标识，例如说 OpenAI 的 "),a("code",[t._v("gpt-3.5-turbo")]),t._v("、"),a("code",[t._v("gpt-4-turbo")]),t._v("，通义千问的 "),a("code",[t._v("qwen-plus")]),t._v("、"),a("code",[t._v("qwen-max")]),t._v(" 等等。")]),t._v(" "),a("p",[t._v("③ "),a("code",[t._v("type")]),t._v(" 字段：模型类型，对应 AiModelTypeEnum 枚举，对应有 CHAT、IMAGE、VOICE、VIDEO、EMBEDDING、RERANK 等。")]),t._v(" "),a("p",[t._v("例如说，CHAT 可用于文本生成，IMAGE 可用于图片生成，VOICE 可用于语音生成，VIDEO 可用于视频生成。")]),t._v(" "),a("p",[t._v("④ "),a("code",[t._v("temperature")]),t._v(" 字段：表示温度参数，对应不同的平台的温度参数，例如说 OpenAI 的 "),a("code",[t._v("temperature")]),t._v("。")]),t._v(" "),a("p",[a("code",[t._v("max_tokens")]),t._v(" 字段：表示单条回复的最大 Token 数量，对应不同的平台的最大 Token 数量，例如说 OpenAI 的 "),a("code",[t._v("gpt-3.5-turbo")]),t._v(" 为 4096，"),a("code",[t._v("gpt-4")]),t._v(" 为 8192。")]),t._v(" "),a("p",[a("code",[t._v("max_contexts")]),t._v(" 字段：表示上下文的最大 Message 数量。因为模型的上下文是有上限的，所以和模型对话时，不会把历史的所有消息都发送过去，而是选择最近的 "),a("code",[t._v("max_contexts")]),t._v(" 组消息。会有一些难理解，具体可以看看 AiChatMessageServiceImpl 的 "),a("code",[t._v("#filterContextMessages(...)")]),t._v(" 方法。")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("疑问：为什么 ai_api_key 和 ai_chat_model 表是分开的？")]),t._v(" "),a("p",[t._v("一个平台有多个模型，它们会共用一个 API 密钥，所以是分开的，方便管理。")])]),t._v(" "),a("h4",{attrs:{id:"_4-2-2-管理后台"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-2-管理后台"}},[t._v("#")]),t._v(" 4.2.2 管理后台")]),t._v(" "),a("p",[t._v("前端对应 [AI 大模型 -> 控制台 -> 模型配置] 菜单，对应 "),a("code",[t._v("yudao-ui-admin-vue3")]),t._v(" 项目的 "),a("code",[t._v("@/views/ai/model/model")]),t._v(" 目录。")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/AI%E6%89%8B%E5%86%8C/AI%E9%85%8D%E7%BD%AE/%E6%A8%A1%E5%9E%8B%E9%85%8D%E7%BD%AE.png",alt:"模型配置"}})]),t._v(" "),a("p",[t._v("它的后端 HTTP 接口，由 "),a("code",[t._v("yudao-module-ai")]),t._v(" 模块的 "),a("code",[t._v("model")]),t._v(" 包的 AiModelController 实现。")]),t._v(" "),a("p",[t._v("注意：新建模型时，需要正确选择 "),a("code",[t._v("type")]),t._v(" 模型类型，否则会导致调用不到对应的模型！！！")])])}),[],!1,null,null,null);a.default=r.exports}}]);