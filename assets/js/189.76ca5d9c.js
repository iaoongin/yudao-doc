(window.webpackJsonp=window.webpackJsonp||[]).push([[189],{518:function(t,a,s){"use strict";s.r(a);var e=s(7),r=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[t._v("本小节，讲解如何将前端 + 后端项目，"),a("strong",[t._v("使用 "),a("a",{attrs:{href:"https://www.bt.cn/u/Nm1mHQ",target:"_blank",rel:"noopener noreferrer"}},[t._v("宝塔"),a("OutboundLink")],1)]),t._v("，部署到 dev 开发环境下的一台 Linux 服务器上。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/Linux%E9%83%A8%E7%BD%B2/01.png",alt:"Linux 部署"}})]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("友情提示：")]),t._v(" "),a("p",[t._v("本文的部署过程，本质和 "),a("a",{attrs:{href:"/deployment-linux"}},[t._v("Linux 部署")]),t._v(" 一样，只是使用了宝塔面板，简化了一些操作。")]),t._v(" "),a("p",[t._v("另外，如果你在部署过程中碰到问题，也可以参考 "),a("a",{attrs:{href:"https://articles.zsxq.com/id_xu72z2zjekbx.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://articles.zsxq.com/id_xu72z2zjekbx.html"),a("OutboundLink")],1),t._v(" 文章，来自球友的宝塔部署。")])]),t._v(" "),a("h2",{attrs:{id:"_1-环境准备"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-环境准备"}},[t._v("#")]),t._v(" 1. 环境准备")]),t._v(" "),a("p",[t._v("需要安装如下环境：")]),t._v(" "),a("ul",[a("li",[t._v("宝塔：运维面板")]),t._v(" "),a("li",[t._v("MySQL：数据库")]),t._v(" "),a("li",[t._v("Redis：缓存")]),t._v(" "),a("li",[t._v("JDK：后端运行环境")]),t._v(" "),a("li",[t._v("Nginx：负载均衡")])]),t._v(" "),a("h3",{attrs:{id:"_1-0-安装宝塔"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-0-安装宝塔"}},[t._v("#")]),t._v(" 1.0 安装宝塔")]),t._v(" "),a("p",[t._v("① 访问 "),a("a",{attrs:{href:"https://www.bt.cn/u/Nm1mHQ",target:"_blank",rel:"noopener noreferrer"}},[t._v("宝塔"),a("OutboundLink")],1),t._v(" 官网，注册账号。因为登录后，需要绑定宝塔账号。")]),t._v(" "),a("p",[t._v("② 访问 "),a("a",{attrs:{href:"https://www.bt.cn/new/download.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.bt.cn/new/download.html"),a("OutboundLink")],1),t._v(" 地址，选择你的系统版本，下载对应的安装包。")]),t._v(" "),a("p",[t._v("这里，我们使用 Centos 9，所以只需要执行如下命令：")]),t._v(" "),a("div",{staticClass:"language-Bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("url")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("https://download.bt.cn/install/install_lts.sh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" /usr/bin/curl "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-sSO")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$url")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("wget")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-O")]),t._v(" install_lts.sh "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$url")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fi")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("bash")]),t._v(" install_lts.sh ed8484bec\n")])])]),a("p",[t._v("整个安装过程预计需要 5 分钟左右，成功后可见如下日志：")]),t._v(" "),a("div",{staticClass:"language-Bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v("面板账户登录信息"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v("\n\n 【云服务器】请在安全组放行 "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("23471")]),t._v(" 端口\n 外网面板地址: https://8.149.143.162:23471/06777072\n 内网面板地址: https://172.26.126.181:23471/06777072\n username: pru5q1ad\n password: 6fc718b8\n")])])]),a("p",[t._v("③ 访问面板地址，使用上面的 "),a("code",[t._v("username")]),t._v("、"),a("code",[t._v("password")]),t._v(" 登录。注意，第一次登录，需要绑定宝塔账号。")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/%E5%AE%9D%E5%A1%94%E9%83%A8%E7%BD%B2/%E5%AE%9D%E5%A1%94%E9%A6%96%E9%A1%B5.png",alt:"宝塔首页"}})]),t._v(" "),a("h3",{attrs:{id:"_1-1-安装-mysql"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-安装-mysql"}},[t._v("#")]),t._v(" 1.1 安装 MySQL")]),t._v(" "),a("p",[t._v("需要安装 MySQL，并导入 SQL 脚本。")]),t._v(" "),a("h4",{attrs:{id:"第一步-安装-mysql"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第一步-安装-mysql"}},[t._v("#")]),t._v(" 第一步，安装 MySQL")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("友情提示：安装 MySQL 是可选步骤，也可以购买 MySQL 云服务。")])]),t._v(" "),a("p",[t._v("在宝塔首页，点击左侧的 [数据库] 菜单，选择 [MySQL] 选项，之后点击 [安装mysql环境] 选项。")]),t._v(" "),a("p",[t._v("再之后，选择 [mysql 8.4.0] 版本，点击 [极速安装] 按钮。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/%E5%AE%9D%E5%A1%94%E9%83%A8%E7%BD%B2/mysql%E5%AE%89%E8%A3%85.png",alt:"安装 MySQL"}})]),t._v(" "),a("h4",{attrs:{id:"第二步-导入-sql-脚本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第二步-导入-sql-脚本"}},[t._v("#")]),t._v(" 第二步，导入 SQL 脚本")]),t._v(" "),a("p",[t._v("① 点击 [添加数据库] 按钮，创建一个名字为 "),a("code",[t._v("ruoyi-vue-pro")]),t._v(" 数据库，。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/%E5%AE%9D%E5%A1%94%E9%83%A8%E7%BD%B2/mysql%E6%96%B0%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93.png",alt:"新建数据库"}})]),t._v(" "),a("p",[t._v("② 点击 [导入] 按钮，再点击 [从本地上传] 按钮，执行数据库对应的 "),a("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/tree/master/sql",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("sql")]),a("OutboundLink")],1),t._v(" 目录下的 SQL 文件，进行初始化。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/%E5%AE%9D%E5%A1%94%E9%83%A8%E7%BD%B2/mysql%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE.png",alt:"导入 SQL"}})]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("疑问：如何使用本地 Navicat 连接该 MySQL？")]),t._v(" "),a("p",[t._v("参考 "),a("a",{attrs:{href:"https://www.bt.cn/bbs/thread-179-1-1.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.bt.cn/bbs/thread-179-1-1.html"),a("OutboundLink")],1),t._v(" 文档。")]),t._v(" "),a("p",[t._v("当然，如果使用阿里云等云服务，相关的 3306 端口也需要放行。")])]),t._v(" "),a("h3",{attrs:{id:"_1-2-安装-redis"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-安装-redis"}},[t._v("#")]),t._v(" 1.2 安装 Redis")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("友情提示：安装 Redis 是可选步骤，也可以购买 Redis 云服务。")])]),t._v(" "),a("p",[t._v("在宝塔首页，点击左侧的 [数据库] 菜单，选择 [Redis] 选项，之后点击 [安装Redis环境] 选项。")]),t._v(" "),a("p",[t._v("再之后，选择 [redis 7.2.4] 版本，点击 [立即安装] 按钮。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/%E5%AE%9D%E5%A1%94%E9%83%A8%E7%BD%B2/redis%E5%AE%89%E8%A3%85.png",alt:"安装 Redis"}})]),t._v(" "),a("h3",{attrs:{id:"_1-3-安装-jdk"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-安装-jdk"}},[t._v("#")]),t._v(" 1.3 安装 JDK")]),t._v(" "),a("p",[t._v("在宝塔首页，点击左侧的 [网站] 菜单，之后选择 [Java 项目] 选项。")]),t._v(" "),a("p",[t._v("再之后，点击 [Java环境管理] 按钮，选择 [jdk1.8.0_371] 版本，点击 [安装] 按钮。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/%E5%AE%9D%E5%A1%94%E9%83%A8%E7%BD%B2/jdk%E5%AE%89%E8%A3%85.png",alt:"安装 JDK"}})]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("友情提示：如果已经安装 JDK，可不安装。建议使用的 JDK 版本为 8、11、17 这三个。")])]),t._v(" "),a("h3",{attrs:{id:"_1-4-安装-nginx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-安装-nginx"}},[t._v("#")]),t._v(" 1.4 安装 Nginx")]),t._v(" "),a("p",[t._v("在宝塔首页，点击左侧的 [网站] 菜单，之后选择 [反向代理] 选项。")]),t._v(" "),a("p",[t._v("再之后，点击 [安装Nginx] 按钮，选择 [nginx 1.24.0] 版本，点击 [极速安装] 按钮。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/%E5%AE%9D%E5%A1%94%E9%83%A8%E7%BD%B2/nginx%E5%AE%89%E8%A3%85.png",alt:"安装 Nginx"}})]),t._v(" "),a("h2",{attrs:{id:"_2-部署后端服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-部署后端服务"}},[t._v("#")]),t._v(" 2. 部署后端服务")]),t._v(" "),a("h4",{attrs:{id:"第一步-修改配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第一步-修改配置"}},[t._v("#")]),t._v(" 第一步，修改配置")]),t._v(" "),a("p",[t._v("后端 dev 开发环境对应的是 "),a("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-server/src/main/resources/application-dev.yaml",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("application-dev.yaml")]),a("OutboundLink")],1),t._v(" 配置文件，主要是修改 MySQL 和 Redis 为你的地址。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/Linux%E9%83%A8%E7%BD%B2/03.png",alt:" 配置文件"}})]),t._v(" "),a("h4",{attrs:{id:"第二步-编译后端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第二步-编译后端"}},[t._v("#")]),t._v(" 第二步，编译后端")]),t._v(" "),a("p",[t._v("在项目的根目录下，执行 "),a("code",[t._v("mvn clean package -Dmaven.test.skip=true")]),t._v(" 命令，编译后端项目，构建出它的 Jar 包。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/Linux%E9%83%A8%E7%BD%B2/02.png",alt:"编译后端"}})]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("疑问：-Dmaven.test.skip=true 是什么意思？")]),t._v(" "),a("p",[t._v("跳过单元测试的执行。如果你项目的单元测试写的不错，建议使用 "),a("code",[t._v("mvn clean package")]),t._v(" 命令，执行单元测试，保证交付的质量。")])]),t._v(" "),a("h4",{attrs:{id:"第三步-上传-jar-包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第三步-上传-jar-包"}},[t._v("#")]),t._v(" 第三步，上传 Jar 包")]),t._v(" "),a("p",[t._v("在宝塔首页，点击左侧的 [文件] 菜单， 在 "),a("code",[t._v("/www/wwwroot")]),t._v(" 目录下，创建一个名字为 "),a("code",[t._v("yudao-server")]),t._v(" 的目录。")]),t._v(" "),a("p",[t._v("之后，将 "),a("code",[t._v("yudao-server.jar")]),t._v(" 上传到该目录下。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/%E5%AE%9D%E5%A1%94%E9%83%A8%E7%BD%B2/server%E4%B8%8A%E4%BC%A0jar%E5%8C%85.png",alt:"上传 Jar 包"}})]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("疑问：如果构建 War 包，部署到 Tomcat 下？")]),t._v(" "),a("p",[t._v("并不推荐采用 War 包部署到 Tomcat 下。如果真的需要，可以参考 "),a("a",{attrs:{href:"https://www.baeldung.com/spring-boot-war-tomcat-deploy",target:"_blank",rel:"noopener noreferrer"}},[t._v("《Deploy a Spring Boot WAR into a Tomcat Server》"),a("OutboundLink")],1),t._v(" 文章。")])]),t._v(" "),a("h4",{attrs:{id:"第四步-启动后端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第四步-启动后端"}},[t._v("#")]),t._v(" 第四步，启动后端")]),t._v(" "),a("p",[t._v("① 在宝塔首页，点击左侧的 [网站] 菜单，之后选择 [Java项目] 选项。")]),t._v(" "),a("p",[t._v("再之后，点击 [添加Java项目] 按钮，选择该上传的 "),a("code",[t._v("yudao-server")]),t._v(" 包，并在“项目启动命令”补充 "),a("code",[t._v("--spring.profiles.active=dev")]),t._v(" 参数。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/%E5%AE%9D%E5%A1%94%E9%83%A8%E7%BD%B2/server%E6%B7%BB%E5%8A%A0%E9%A1%B9%E7%9B%AE.png",alt:"添加 Java 项目"}})]),t._v(" "),a("p",[t._v("② 后续，可以点击该项目的 [设置] 按钮，进行日志管理、性能监控、负载状态、配置文件等等。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/%E5%AE%9D%E5%A1%94%E9%83%A8%E7%BD%B2/server%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86.png",alt:"Java 项目设置"}})]),t._v(" "),a("h2",{attrs:{id:"_3-部署前端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-部署前端"}},[t._v("#")]),t._v(" 3. 部署前端")]),t._v(" "),a("p",[t._v("项目的管理后台有 3 个版本（只需要看你的版本即可）：")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("yudao-ui-admin-vue3")]),t._v("：基于 Vue3 + element-plus")]),t._v(" "),a("li",[a("code",[t._v("yudao-ui-admin-vben")]),t._v("：基于 Vue3 + vben5.0(ant-design-vue)")]),t._v(" "),a("li",[a("code",[t._v("yudao-ui-admin-vue2")]),t._v("：基于 Vue2 + element-ui")])]),t._v(" "),a("p",[t._v("注意，前端无法直接启动，而是需要通过 Nginx 转发读取前端构建出来的静态文件，最终都放在服务器上的 "),a("code",[t._v("/www/wwwroot/yudao-ui-admin")]),t._v(" 目录下。")]),t._v(" "),a("h3",{attrs:{id:"_3-1-yudao-ui-admin-vue3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-yudao-ui-admin-vue3"}},[t._v("#")]),t._v(" 3.1 yudao-ui-admin-vue3")]),t._v(" "),a("p",[t._v("基于 Vue3 + element-plus")]),t._v(" "),a("h4",{attrs:{id:"第一步-修改配置-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第一步-修改配置-2"}},[t._v("#")]),t._v(" 第一步，修改配置")]),t._v(" "),a("p",[t._v("前端 dev 开发环境对应的是 "),a("a",{attrs:{href:"https://github.com/yudaocode/yudao-ui-admin-vue3/blob/master/.env.dev#L6-L7",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v(".env.dev")]),a("OutboundLink")],1),t._v(" 配置文件，主要是修改 "),a("code",[t._v("VITE_BASE_URL")]),t._v(" 为你的后端项目的访问地址。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/Linux%E9%83%A8%E7%BD%B2/ep-env.png",alt:" 配置文件"}})]),t._v(" "),a("h4",{attrs:{id:"第二步-编译前端"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第二步-编译前端"}},[t._v("#")]),t._v(" 第二步，编译前端")]),t._v(" "),a("p",[t._v("在前端项目的根目录下，执行 "),a("code",[t._v("npm run build:dev")]),t._v(" 命令，编译前端项目，构建出它的 "),a("code",[t._v("dist")]),t._v(" 文件，里面是 HTML、CSS、JavaScript 等静态文件。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/Linux%E9%83%A8%E7%BD%B2/ep-%E7%BC%96%E8%AF%91.png",alt:"编译前端"}})]),t._v(" "),a("p",[t._v("如下想要打包其它环境，可使用如下命令：")]),t._v(" "),a("div",{staticClass:"language-Bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run build:prod "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 打包 prod 生产环境")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run build:stage "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 打包 stage 预发布环境")]),t._v("\n")])])]),a("p",[t._v("如果是在服务器上构建，并且出现卡死的情况，可以参考 "),a("a",{attrs:{href:"https://t.zsxq.com/Quq1U",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://t.zsxq.com/Quq1U"),a("OutboundLink")],1),t._v(" 或 "),a("a",{attrs:{href:"https://gitee.com/yudaocode/yudao-ui-admin-vue3/issues/IAU0T3",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://gitee.com/yudaocode/yudao-ui-admin-vue3/issues/IAU0T3"),a("OutboundLink")],1),t._v(" 解决")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("其它高级参数说明【可暂时不看】：")]),t._v(" "),a("p",[t._v("① "),a("code",[t._v("VITE_PUBLIC_PATH")]),t._v("：前端打包的路径（静态资源的基础路径），一般默认为 "),a("code",[t._v("/")]),t._v(" 即可。目前有两种用法：")]),t._v(" "),a("p",[t._v("第一种，可用于二级目录部署。例如说，"),a("code",[t._v("VITE_PUBLIC_PATH")]),t._v(" 设置为 "),a("code",[t._v("/demo")]),t._v(" 。然后 Nginx 配置时，需要特殊注意，如下所示：")]),t._v(" "),a("div",{staticClass:"language-Bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("        location /demo "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 注意点 1：不需要 / 结尾")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 注意点 2：二级路由时需要使用别名 alias，不用 root")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("alias")]),t._v("   /work/projects/yudao-ui-admin/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 注意点 3：需要 / 结尾")]),t._v("\n            index  index.html index.htm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            try_files "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v("/ /index.html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("第二种，可用于七牛等 CDN 服务，读取前端的静态文件，提升访问速度，建议 prod 生产环境使用。例如说，我们演示环境的 "),a("code",[t._v("VITE_PUBLIC_PATH")]),t._v(" 是 "),a("code",[t._v("http://static-vue3.yudao.iocoder.cn/")]),t._v(" 。")]),t._v(" "),a("p",[t._v("具体操作，可参考文章的 "),a("a",{attrs:{href:"https://blog.csdn.net/weixin_71403100/article/details/132037721",target:"_blank",rel:"noopener noreferrer"}},[t._v("《Vue 项目使用七牛云 CDN 存放静态资源》"),a("OutboundLink")],1),t._v(" 的「二、实现方式 」部分，只是最终的“修改 index.html 中静态资源引用”，变成 "),a("code",[t._v("PUBLIC_PATH")]),t._v(" 修改即可。")])]),t._v(" "),a("h4",{attrs:{id:"第三步-上传-dist-文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第三步-上传-dist-文件"}},[t._v("#")]),t._v(" 第三步，上传 "),a("code",[t._v("dist")]),t._v(" 文件")]),t._v(" "),a("p",[t._v("① 选中本地的 "),a("code",[t._v("dist")]),t._v(" 内的所有文件，进行压缩。（注意，不是压缩 "),a("code",[t._v("dist")]),t._v(" 文件夹，而是选中它里面所有的内容！！！）")]),t._v(" "),a("p",[t._v("② 在宝塔首页，点击左侧的 [文件] 菜单， 在 "),a("code",[t._v("/www/wwwroot")]),t._v(" 目录下，创建一个名字为 "),a("code",[t._v("yudao-ui-admin")]),t._v(" 的目录。")]),t._v(" "),a("p",[t._v("之后，上传 "),a("code",[t._v("dist.zip")]),t._v(" 到该目录下，并进行解压。最终如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/%E5%AE%9D%E5%A1%94%E9%83%A8%E7%BD%B2/ep-dist.png",alt:"上传  文件"}})]),t._v(" "),a("h3",{attrs:{id:"_3-2-yudao-ui-admin-vben"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-yudao-ui-admin-vben"}},[t._v("#")]),t._v(" 3.2 yudao-ui-admin-vben")]),t._v(" "),a("p",[t._v("基于 Vue3 + vben5.0(ant-design-vue)")]),t._v(" "),a("h4",{attrs:{id:"第一步-修改配置-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第一步-修改配置-3"}},[t._v("#")]),t._v(" 第一步，修改配置")]),t._v(" "),a("p",[t._v("前端 production 开发环境对应的是 "),a("a",{attrs:{href:"https://github.com/yudaocode/yudao-ui-admin-vben/blob/master/.env.production#L15-L21",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v(".env.production")]),a("OutboundLink")],1),t._v(" 配置文件，主要是修改 "),a("code",[t._v("VITE_GLOB_BASE_URL")]),t._v("、"),a("code",[t._v("VITE_GLOB_API_URL")]),t._v(" 为你的后端项目的访问地址。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/Linux%E9%83%A8%E7%BD%B2/vben-env.png",alt:" 配置文件"}})]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("其它高级参数说明【可暂时不看】：")]),t._v(" "),a("p",[t._v("① "),a("code",[t._v("VITE_PUBLIC_PATH")]),t._v("：前端打包的路径（静态资源的基础路径），一般默认为 "),a("code",[t._v("/")]),t._v(" 即可。目前有两种用法：")]),t._v(" "),a("p",[t._v("第一种，可用于二级目录部署。例如说，"),a("code",[t._v("VITE_PUBLIC_PATH")]),t._v(" 设置为 "),a("code",[t._v("/demo")]),t._v(" 。然后 Nginx 配置时，需要特殊注意，如下所示：")]),t._v(" "),a("div",{staticClass:"language-Bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("        location /demo "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 注意点 1：不需要 / 结尾")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 注意点 2：二级路由时需要使用别名 alias，不用 root")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("alias")]),t._v("   /work/projects/yudao-ui-admin/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 注意点 3：需要 / 结尾")]),t._v("\n            index  index.html index.htm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            try_files "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v("/ /index.html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("第二种，可用于七牛等 CDN 服务，读取前端的静态文件，提升访问速度，建议 prod 生产环境使用。例如说，我们演示环境的 "),a("code",[t._v("VITE_PUBLIC_PATH")]),t._v(" 是 "),a("code",[t._v("http://static-vue3.yudao.iocoder.cn/")]),t._v(" 。")]),t._v(" "),a("p",[t._v("具体操作，可参考文章的 "),a("a",{attrs:{href:"https://blog.csdn.net/weixin_71403100/article/details/132037721",target:"_blank",rel:"noopener noreferrer"}},[t._v("《Vue 项目使用七牛云 CDN 存放静态资源》"),a("OutboundLink")],1),t._v(" 的「二、实现方式 」部分，只是最终的“修改 index.html 中静态资源引用”，变成 "),a("code",[t._v("PUBLIC_PATH")]),t._v(" 修改即可。")])]),t._v(" "),a("h4",{attrs:{id:"第二步-编译前端-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第二步-编译前端-2"}},[t._v("#")]),t._v(" 第二步，编译前端")]),t._v(" "),a("p",[t._v("在前端项目的根目录下，执行 "),a("code",[t._v("npm run build")]),t._v(" 命令，编译前端项目，构建出它的 "),a("code",[t._v("dist")]),t._v(" 文件，里面是 HTML、CSS、JavaScript 等静态文件。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/Linux%E9%83%A8%E7%BD%B2/vben-%E7%BC%96%E8%AF%91.png",alt:"编译前端"}})]),t._v(" "),a("h4",{attrs:{id:"第三步-上传-dist-文件-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第三步-上传-dist-文件-2"}},[t._v("#")]),t._v(" 第三步，上传 "),a("code",[t._v("dist")]),t._v(" 文件")]),t._v(" "),a("p",[t._v("① 选中本地的 "),a("code",[t._v("dist")]),t._v(" 内的所有文件，进行压缩。（注意，不是压缩 "),a("code",[t._v("dist")]),t._v(" 文件夹，而是选中它里面所有的内容！！！）")]),t._v(" "),a("p",[t._v("② 在宝塔首页，点击左侧的 [文件] 菜单， 在 "),a("code",[t._v("/www/wwwroot")]),t._v(" 目录下，创建一个名字为 "),a("code",[t._v("yudao-ui-admin")]),t._v(" 的目录。")]),t._v(" "),a("p",[t._v("之后，上传 "),a("code",[t._v("dist.zip")]),t._v(" 到该目录下，并进行解压。最终如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/%E5%AE%9D%E5%A1%94%E9%83%A8%E7%BD%B2/vben-dist.png",alt:"上传  文件"}})]),t._v(" "),a("h3",{attrs:{id:"_3-3-yudao-ui-admin-vue2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-yudao-ui-admin-vue2"}},[t._v("#")]),t._v(" 3.3 yudao-ui-admin-vue2")]),t._v(" "),a("p",[t._v("基于 Vue2 + element-ui")]),t._v(" "),a("h4",{attrs:{id:"第一步-修改配置-4"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第一步-修改配置-4"}},[t._v("#")]),t._v(" 第一步，修改配置")]),t._v(" "),a("p",[t._v("前端 dev 开发环境对应的是 "),a("a",{attrs:{href:"https://github.com/yudaocode/yudao-ui-admin-vue2/blob/master/.env.dev",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v(".env.dev")]),a("OutboundLink")],1),t._v(" 配置文件，主要是修改 "),a("code",[t._v("VUE_APP_BASE_API")]),t._v(" 为你的后端项目的访问地址。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/Linux%E9%83%A8%E7%BD%B2/eu-env.png",alt:" 配置文件"}})]),t._v(" "),a("h4",{attrs:{id:"第二步-编译前端-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第二步-编译前端-3"}},[t._v("#")]),t._v(" 第二步，编译前端")]),t._v(" "),a("p",[t._v("在前端项目的根目录下，执行 "),a("code",[t._v("npm run build:dev")]),t._v(" 命令，编译前端项目，构建出它的 "),a("code",[t._v("dist")]),t._v(" 文件，里面是 HTML、CSS、JavaScript 等静态文件。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/Linux%E9%83%A8%E7%BD%B2/eu-%E7%BC%96%E8%AF%91.png",alt:"编译前端"}})]),t._v(" "),a("p",[t._v("如下想要打包其它环境，可使用如下命令：")]),t._v(" "),a("div",{staticClass:"language-Bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run build:prod "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 打包 prod 生产环境")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run build:stage "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 打包 stage 预发布环境")]),t._v("\n")])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("其它高级参数说明【可暂时不看】：")]),t._v(" "),a("p",[t._v("① "),a("code",[t._v("PUBLIC_PATH")]),t._v("：可用于七牛等 CDN 服务，读取前端的静态文件，提升访问速度，建议 prod 生产环境使用。示例如下：")]),t._v(" "),a("p",[t._v("可参考文章的 "),a("a",{attrs:{href:"https://blog.csdn.net/weixin_71403100/article/details/132037721",target:"_blank",rel:"noopener noreferrer"}},[t._v("《Vue 项目使用七牛云 CDN 存放静态资源》"),a("OutboundLink")],1),t._v(" 的「二、实现方式 」部分，只是最终的“修改 index.html 中静态资源引用”，变成 "),a("code",[t._v("PUBLIC_PATH")]),t._v(" 修改即可。")]),t._v(" "),a("p",[t._v("② "),a("code",[t._v("VUE_APP_APP_NAME")]),t._v("：二级部署路径，默认为 "),a("code",[t._v("/")]),t._v(" 根目录，一般不用修改。")]),t._v(" "),a("p",[t._v("③ "),a("code",[t._v("mode")]),t._v("：前端路由的模式，默认采用 "),a("code",[t._v("history")]),t._v(" 路由，一般不用修改。可以通过修改 "),a("a",{attrs:{href:"https://github.com/yudaocode/yudao-ui-admin-vue2/blob/master/src/router/index.js#L173-L178",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("router/index.js")]),a("OutboundLink")],1),t._v(" 来设置为 "),a("code",[t._v("hash")]),t._v(" 路由，示例如下：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/Linux%E9%83%A8%E7%BD%B2/eu-mode.png",alt:" 参数"}})])]),t._v(" "),a("h4",{attrs:{id:"第三步-上传-dist-文件-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第三步-上传-dist-文件-3"}},[t._v("#")]),t._v(" 第三步，上传 "),a("code",[t._v("dist")]),t._v(" 文件")]),t._v(" "),a("p",[t._v("① 选中本地的 "),a("code",[t._v("dist")]),t._v(" 内的所有文件，进行压缩。（注意，不是压缩 "),a("code",[t._v("dist")]),t._v(" 文件夹，而是选中它里面所有的内容！！！）")]),t._v(" "),a("p",[t._v("② 在宝塔首页，点击左侧的 [文件] 菜单， 在 "),a("code",[t._v("/www/wwwroot")]),t._v(" 目录下，创建一个名字为 "),a("code",[t._v("yudao-ui-admin")]),t._v(" 的目录。")]),t._v(" "),a("p",[t._v("之后，上传 "),a("code",[t._v("dist.zip")]),t._v(" 到该目录下，并进行解压。最终如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/%E5%AE%9D%E5%A1%94%E9%83%A8%E7%BD%B2/eu-dist.png",alt:"上传  文件"}})]),t._v(" "),a("h2",{attrs:{id:"_4-部署-nginx-转发"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-部署-nginx-转发"}},[t._v("#")]),t._v(" 4. 部署 Nginx 转发")]),t._v(" "),a("p",[t._v("两种 Nginx 的配置，分别满足服务器 IP、独立域名的不同场景。")]),t._v(" "),a("h3",{attrs:{id:"_4-1-服务器-ip-场景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-服务器-ip-场景"}},[t._v("#")]),t._v(" 4.1 服务器 IP 场景")]),t._v(" "),a("h4",{attrs:{id:"第一步-配置前端转发"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第一步-配置前端转发"}},[t._v("#")]),t._v(" 第一步，配置前端转发")]),t._v(" "),a("p",[t._v("在宝塔首页，点击左侧的 [网站] 菜单，之后选择 [HTML项目] 选项。")]),t._v(" "),a("p",[t._v("之后，点击 [添加HTML项目] 按钮，填写备注为 "),a("code",[t._v("yudao-ui-admin")]),t._v("，并在“根目录”选择 "),a("code",[t._v("/www/wwwroot/yudao-ui-admin")]),t._v(" 目录。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/%E5%AE%9D%E5%A1%94%E9%83%A8%E7%BD%B2/nginx-ip-%E5%89%8D%E7%AB%AF.png",alt:"添加 HTML 项目"}})]),t._v(" "),a("h4",{attrs:{id:"第二步-配置后端转发"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第二步-配置后端转发"}},[t._v("#")]),t._v(" 第二步，配置后端转发")]),t._v(" "),a("p",[t._v("点击该项目的 [设置] 按钮，选中 [伪静态] 选项，进行后端的转发配置。如下图所示：")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("疑问：为什么要在 HTML 项目下配置后端转发？")]),t._v(" "),a("p",[t._v("因为前端和后端共享了同一个 IP 地址，导致它在宝塔进行 Nginx 配置转发时，"),a("code",[t._v("server_name")]),t._v(" 冲突了！！！")]),t._v(" "),a("p",[t._v("另外，下面有个 "),a("code",[t._v("try_files")]),t._v(" 配置，是为了解决前端刷新 404 问题，参考自 "),a("a",{attrs:{href:"https://blog.csdn.net/ITMyFavorite/article/details/136175136",target:"_blank",rel:"noopener noreferrer"}},[t._v("《Vue 项目使用宝塔面板部署刷新 404 问题》"),a("OutboundLink")],1),t._v(" 文章。")])]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/%E5%AE%9D%E5%A1%94%E9%83%A8%E7%BD%B2/nginx-ip-%E5%90%8E%E7%AB%AF.png",alt:"后端转发"}})]),t._v(" "),a("div",{staticClass:"language-Bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 请将伪静态规则或自定义NGINX配置填写到此处")]),t._v("\nlocation / "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n  try_files "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$uri")]),t._v("/ /index.html"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 重要！！！解决前端刷新 404 问题")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nlocation /admin-api/ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 后端项目 - 管理后台")]),t._v("\n    proxy_pass http://localhost:48080/admin-api/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 重要！！！proxy_pass 需要设置为后端项目所在服务器的 IP")]),t._v("\n    proxy_set_header Host "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$http_host")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    proxy_set_header X-Real-IP "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$remote_addr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    proxy_set_header REMOTE-HOST "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$remote_addr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    proxy_set_header X-Forwarded-For "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$proxy_add_x_forwarded_for")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nlocation /app-api/ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 后端项目 - 用户 App")]),t._v("\n    proxy_pass http://localhost:48080/app-api/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 重要！！！proxy_pass 需要设置为后端项目所在服务器的 IP")]),t._v("\n    proxy_set_header Host "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$http_host")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    proxy_set_header X-Real-IP "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$remote_addr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    proxy_set_header REMOTE-HOST "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$remote_addr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    proxy_set_header X-Forwarded-For "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$proxy_add_x_forwarded_for")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h4",{attrs:{id:"第三步-简单测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第三步-简单测试"}},[t._v("#")]),t._v(" 第三步，简单测试")]),t._v(" "),a("p",[t._v("① 请求 "),a("a",{attrs:{href:"http://192.168.225.2/admin-api/",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://192.168.225.2/admin-api/"),a("OutboundLink")],1),t._v(" 地址，成功访问后端项目，返回结果如下：")]),t._v(" "),a("div",{staticClass:"language-JSON extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"code"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("401")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"data"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token null keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"msg"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"账号未登录"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("② 请求 "),a("a",{attrs:{href:"http://192.168.225.2",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://192.168.225.2"),a("OutboundLink")],1),t._v(" 地址，成功访问前端项目，返回前端界面如下：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/Linux%E9%83%A8%E7%BD%B2/14.png",alt:"前端界面"}})]),t._v(" "),a("p",[t._v("③ 如果你使用到 WebSocket 的话，需要额外对 "),a("code",[t._v("/infra/ws")]),t._v(" 路径进行配置，具体可见 "),a("a",{attrs:{href:"https://t.zsxq.com/LQEfC",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://t.zsxq.com/LQEfC"),a("OutboundLink")],1),t._v(" 链接。")]),t._v(" "),a("h3",{attrs:{id:"_4-2-独立域名场景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-独立域名场景"}},[t._v("#")]),t._v(" 4.2 独立域名场景")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("友情提示：在前端项目的编译时，需要把 `VUE_APP_BASE_API` 修改为后端项目对应的域名。")]),t._v(" "),a("p",[t._v("例如说，这里使用的是 "),a("code",[t._v("http://api.iocoder.cn")])])]),t._v(" "),a("h4",{attrs:{id:"第一步-配置前端转发-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第一步-配置前端转发-2"}},[t._v("#")]),t._v(" 第一步，配置前端转发")]),t._v(" "),a("p",[t._v("① 在宝塔首页，点击左侧的 [网站] 菜单，之后选择 [HTML项目] 选项。")]),t._v(" "),a("p",[t._v("之后，点击 [添加HTML项目] 按钮，填写备注为 "),a("code",[t._v("yudao-ui-admin")]),t._v("，并在“根目录”选择 "),a("code",[t._v("/www/wwwroot/yudao-ui-admin")]),t._v(" 目录。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/%E5%AE%9D%E5%A1%94%E9%83%A8%E7%BD%B2/nginx-domain-%E5%89%8D%E7%AB%AF.png",alt:"添加 HTML 项目"}})]),t._v(" "),a("p",[t._v("② 点击该项目的 [设置] 按钮，选中 [伪静态] 选项，进行 "),a("code",[t._v("try_files")]),t._v(" 的转发配置。如下图所示：")]),t._v(" "),a("div",{staticClass:"language-tip 友情提示： extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("# 请将伪静态规则或自定义NGINX配置填写到此处\nlocation / { \n  try_files $uri $uri/ /index.html; ## 重要！！！解决前端刷新 404 问题\n}\n")])])]),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/%E5%AE%9D%E5%A1%94%E9%83%A8%E7%BD%B2/nginx-domain-%E5%89%8D%E7%AB%AF2.png",alt:"前端转发"}})]),t._v(" "),a("h4",{attrs:{id:"第二步-配置后端转发-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第二步-配置后端转发-2"}},[t._v("#")]),t._v(" 第二步，配置后端转发")]),t._v(" "),a("p",[t._v("① 点击 Java 项目的 [设置] 按钮，选中 [域名管理] 选项，在“域名”输入后端的域名，如 "),a("code",[t._v("api.iocoder.cn")]),t._v("。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/%E5%AE%9D%E5%A1%94%E9%83%A8%E7%BD%B2/nginx-domain-%E5%90%8E%E7%AB%AF.png",alt:"域名管理"}})]),t._v(" "),a("p",[t._v("② 选中 [外网访问] 选项，把“外网映射”选上。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/%E5%AE%9D%E5%A1%94%E9%83%A8%E7%BD%B2/nginx-domain-%E5%90%8E%E7%AB%AF2.png",alt:"外网映射"}})]),t._v(" "),a("p",[t._v("③ 选中 [配置文件] 选项，选择 [伪静态配置文件] 选项，进行后端的转发配置。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/%E5%AE%9D%E5%A1%94%E9%83%A8%E7%BD%B2/nginx-domain-%E5%90%8E%E7%AB%AF3.png",alt:"后端转发"}})]),t._v(" "),a("div",{staticClass:"language-Bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 请将伪静态规则或自定义NGINX配置填写到此处")]),t._v("\nlocation /admin-api/ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 后端项目 - 管理后台")]),t._v("\n    proxy_pass http://127.0.0.1:48080/admin-api/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 重要！！！proxy_pass 需要设置为后端项目所在服务器的 IP")]),t._v("\n    proxy_set_header Host "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$http_host")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    proxy_set_header X-Real-IP "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$remote_addr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    proxy_set_header REMOTE-HOST "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$remote_addr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    proxy_set_header X-Forwarded-For "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$proxy_add_x_forwarded_for")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nlocation /app-api/ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 后端项目 - 用户 App")]),t._v("\n    proxy_pass http://127.0.0.1:48080/app-api/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## 重要！！！proxy_pass 需要设置为后端项目所在服务器的 IP")]),t._v("\n    proxy_set_header Host "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$http_host")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    proxy_set_header X-Real-IP "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$remote_addr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    proxy_set_header REMOTE-HOST "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$remote_addr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    proxy_set_header X-Forwarded-For "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$proxy_add_x_forwarded_for")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h4",{attrs:{id:"第三步-简单测试-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第三步-简单测试-2"}},[t._v("#")]),t._v(" 第三步，简单测试")]),t._v(" "),a("p",[t._v("① 请求 "),a("a",{attrs:{href:"http://api.iocoder.cn/admin-api/",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://api.iocoder.cn/admin-api/"),a("OutboundLink")],1),t._v(" 地址，成功访问后端项目，返回结果如下：")]),t._v(" "),a("div",{staticClass:"language-JSON extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"code"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("401")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"data"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token null keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"msg"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"账号未登录"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("② 请求 "),a("a",{attrs:{href:"http://admin.iocoder.cn",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://admin.iocoder.cn"),a("OutboundLink")],1),t._v(" 地址，成功访问前端项目，返回前端界面如下：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/%E8%BF%90%E7%BB%B4%E6%89%8B%E5%86%8C/Linux%E9%83%A8%E7%BD%B2/15.png",alt:"前端界面"}})]),t._v(" "),a("h2",{attrs:{id:"_666-更多说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_666-更多说明"}},[t._v("#")]),t._v(" 666. 更多说明")]),t._v(" "),a("p",[t._v("① 积木报表菜单，无法访问。参考 "),a("a",{attrs:{href:"https://t.zsxq.com/vBkup",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://t.zsxq.com/vBkup"),a("OutboundLink")],1),t._v(" 解决。")]),t._v(" "),a("p",[t._v("② 如果希望分离 Maven 依赖 lib 打包，可参考 "),a("a",{attrs:{href:"https://gitee.com/zhijiantianya/ruoyi-vue-pro/pulls/1259/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://gitee.com/zhijiantianya/ruoyi-vue-pro/pulls/1259/"),a("OutboundLink")],1),t._v(" 贡献。")])])}),[],!1,null,null,null);a.default=r.exports}}]);