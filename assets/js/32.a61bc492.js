(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{361:function(t,e,r){"use strict";r.r(e);var o=r(7),a=Object(o.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h2",{attrs:{id:"oauth-2-0-是什么"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#oauth-2-0-是什么"}},[t._v("#")]),t._v(" OAuth 2.0 是什么？")]),t._v(" "),e("p",[t._v("OAuth 2.0 的概念讲解，可以阅读如下三篇文章：")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://www.iocoder.cn/Fight/ruanyifeng-oauth_2_0/?self",target:"_blank",rel:"noopener noreferrer"}},[t._v("《理解 OAuth 2.0》"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://www.iocoder.cn/Fight/ruanyifeng-oauth_design/?self",target:"_blank",rel:"noopener noreferrer"}},[t._v("《OAuth 2.0 的一个简单解释》"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://www.iocoder.cn/Fight/ruanyifeng-oauth-grant-types/?self",target:"_blank",rel:"noopener noreferrer"}},[t._v("《OAuth 2.0 的四种方式》"),e("OutboundLink")],1)])]),t._v(" "),e("p",[t._v("重点是理解 "),e("strong",[t._v("授权码模式")]),t._v(" 和 "),e("strong",[t._v("密码模式")]),t._v("，它们是最常用的两种授权模式。")]),t._v(" "),e("p",[t._v("本文，我们也会基于它们，分别实现 SSO 单点登录。")]),t._v(" "),e("h2",{attrs:{id:"oauth-2-0-授权模式的选择"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#oauth-2-0-授权模式的选择"}},[t._v("#")]),t._v(" OAuth 2.0 授权模式的选择？")]),t._v(" "),e("p",[t._v("授权模式的选择，其实非常简单，总结起来就是一张图：")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/OAuth2/%E6%8E%88%E6%9D%83%E6%A8%A1%E5%BC%8F%E7%9A%84%E9%80%89%E6%8B%A9.png",alt:"授权模式的选择"}})]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("问题一：什么场景下，使用客户端模式（Client Credentials）？")])]),t._v(" "),e("p",[t._v("如果令牌拥有者是"),e("strong",[t._v("机器")]),t._v("的情况下，那就使用客户端模式。 例如说：")]),t._v(" "),e("ul",[e("li",[t._v("开发了一个开放平台，提供给其它外部服务调用")]),t._v(" "),e("li",[t._v("开发了一个 RPC 服务，提供给其它内部服务调用")])]),t._v(" "),e("p",[t._v("实际的案例，我们接入微信公众号时，会使用 "),e("code",[t._v("appid")]),t._v(" 和 "),e("code",[t._v("secret")]),t._v(" 参数，"),e("a",{attrs:{href:"https://developers.weixin.qq.com/doc/offiaccount/Basic_Information/Get_access_token.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("获取 Access token"),e("OutboundLink")],1),t._v(" 访问令牌。")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("问题二：什么场景下，使用密码模式（Resource Owner Password Credentials）？")])]),t._v(" "),e("p",[t._v("接入的 Client 客户端，是属于"),e("strong",[t._v("自己")]),t._v("的情况下，可以使用密码模式。 例如说：")]),t._v(" "),e("ul",[e("li",[t._v("客户端是你自己公司的 App 或网页，然后授权服务也是你公司的")])]),t._v(" "),e("p",[t._v("不过，如果客户端是"),e("strong",[t._v("第三方")]),t._v("的情况下，使用密码模式的话，该客户端是可以拿到用户的账号、密码，存在安全的风险，此时可以考虑使用授权码或简化模式。")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("问题三：什么场景下，使用授权码模式（Authorization Code）？")])]),t._v(" "),e("p",[t._v("接入的 Client 客户端，是属于"),e("strong",[t._v("第三方")]),t._v("的情况下，可以使用授权码模式。例如说：")]),t._v(" "),e("ul",[e("li",[t._v("客户端是你自己公司的 App 或网页，作为第三方，接入 "),e("a",{attrs:{href:"https://developers.weixin.qq.com/doc/offiaccount/OA_Web_Apps/Wechat_webpage_authorization.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("微信"),e("OutboundLink")],1),t._v("、"),e("a",{attrs:{href:"https://wiki.connect.qq.com/oauth2-0%E7%AE%80%E4%BB%8B",target:"_blank",rel:"noopener noreferrer"}},[t._v("QQ"),e("OutboundLink")],1),t._v("、"),e("a",{attrs:{href:"https://open.dingtalk.com/document/mobile-app-guide/mobile-application-access",target:"_blank",rel:"noopener noreferrer"}},[t._v("钉钉"),e("OutboundLink")],1),t._v(" 等等进行 OAuth 2.0 登录")])]),t._v(" "),e("p",[t._v("当然，如果客户端是"),e("strong",[t._v("自己")]),t._v("的情况下，也可以采用授权码模式。例如说：")]),t._v(" "),e("ul",[e("li",[t._v("客户端是腾讯旗下的各种游戏，可使用微信、QQ，接入 "),e("a",{attrs:{href:"https://developers.weixin.qq.com/doc/offiaccount/OA_Web_Apps/Wechat_webpage_authorization.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("微信"),e("OutboundLink")],1),t._v("、"),e("a",{attrs:{href:"https://wiki.connect.qq.com/oauth2-0%E7%AE%80%E4%BB%8B",target:"_blank",rel:"noopener noreferrer"}},[t._v("QQ"),e("OutboundLink")],1),t._v(" 等等进行 OAuth 2.0 登录")]),t._v(" "),e("li",[t._v("客户端是公司内的各种管理后台（ERP、OA、CRM 等），跳转到统一的 SSO 单点登录，使用授权码模式进行授权")])]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("问题四：什么场景下，使用简化模式（Implicit）？")])]),t._v(" "),e("p",[t._v("简化模式，"),e("strong",[t._v("简化")]),t._v(" 的是授权码模式的流程的 "),e("strong",[t._v("第二步")]),t._v("，差异在于：")]),t._v(" "),e("ul",[e("li",[t._v("授权码模式：授权完成后，获得的是 code 授权码，需要 Server Side 服务端使用该授权码，再向授权服务器获取 Access Token 访问令牌")]),t._v(" "),e("li",[t._v("简化模式：授权完成后，Client Side 客户端直接获得 Access Token 访问令牌")])]),t._v(" "),e("p",[t._v("暂时没有特别好的案例，感兴趣可以看看如下文档，也可以不看：")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://wiki.connect.qq.com/%e5%bc%80%e5%8f%91%e6%94%bb%e7%95%a5_client-side",target:"_blank",rel:"noopener noreferrer"}},[t._v("《QQ OAuth 2.0 开发指定 —— 开发攻略_Client-side》"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"http://developer.baidu.com/wiki/index.php?title=docs/oauth/implicit",target:"_blank",rel:"noopener noreferrer"}},[t._v("《百度 OAuth —— Implicit Grant 授权》"),e("OutboundLink")],1)])]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("问题五：该项目中，使用了哪些授权模式？")])]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/OAuth2/%E9%A1%B9%E7%9B%AE%E4%BD%BF%E7%94%A8%E7%9A%84%E6%8E%88%E6%9D%83%E6%A8%A1%E5%BC%8F.png",alt:"项目使用的授权模式"}})]),t._v(" "),e("p",[t._v("如上图所示，分成 "),e("strong",[t._v("外部授权")]),t._v(" 和 "),e("strong",[t._v("内部登录")]),t._v(" 两种方式。")]),t._v(" "),e("p",[t._v("① 红色的“外部授权”：基于【授权码模式】，实现 SSO 单点登录，将用户授权给接入的客户端。客户端可以是内部的其它管理系统，也可以是外部的第三方。")]),t._v(" "),e("p",[t._v("② 绿色的“内部登录”：管理后台的登录接口，还是采用传统的 "),e("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-system/yudao-module-system-biz/src/main/java/cn/iocoder/yudao/module/system/controller/admin/auth/AuthController.java#L61-L67",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("/admin-api/system/auth/login")]),e("OutboundLink")],1),t._v(" 账号密码登录，并没有使用【密码模式】，主要考虑降低大家的学习成本，如果没有将用户授权给其它系统的情况下，这样做已经可以很好的满足业务的需要。当然，这里也可以将管理后台作为一个客户端，使用【密码模式】进行授权。")]),t._v(" "),e("p",[t._v("另外，考虑到 OAuth 2.0 使用的访问令牌 + 刷新令牌可以提供更好的安全性，所以即使是传统的账号密码登录，也复用了它作为令牌的实现。")]),t._v(" "),e("h2",{attrs:{id:"oauth-2-0-技术选型"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#oauth-2-0-技术选型"}},[t._v("#")]),t._v(" OAuth 2.0 技术选型？")]),t._v(" "),e("p",[t._v("实现 OAuth 2.0 的功能，一般采用 "),e("a",{attrs:{href:"https://spring.io/projects/spring-security-oauth",target:"_blank",rel:"noopener noreferrer"}},[t._v("Spring Security OAuth"),e("OutboundLink")],1),t._v(" 或 "),e("a",{attrs:{href:"https://spring.io/projects/spring-authorization-server",target:"_blank",rel:"noopener noreferrer"}},[t._v("Spring Authorization Server"),e("OutboundLink")],1),t._v("(SAS) 框架，前者已废弃，被后者所替代。但是使用它们，会面临三大问题：")]),t._v(" "),e("ul",[e("li",[t._v("学习成本大：SAS 是新出的框架，入门容易精通难，引入项目中需要花费 1-2 周深入学习")]),t._v(" "),e("li",[t._v("排查问题难：使用碰到问题时，往往需要调试到源码层面，团队只有个别人具备这种能力")]),t._v(" "),e("li",[t._v("定制成本高：根据业务需要，想要在 SAS 上定制功能，对源码要有不错的掌控力，难度可能过大")])]),t._v(" "),e("p",[t._v("⚔ 因此，项目参考多个 OAuth 2.0 框架，"),e("strong",[t._v("自研")]),t._v("实现 OAuth 2.0 的功能，具备学习成本小、排查问题容易、定制成本低的优点，支持多种授权模式，并内置 SSO 单点登录的功能。")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("友情提示：具备一定规模的互联网公司，基本不会直接采用 Spring Security OAuth 或 Spring Authorization Server 框架，也是采用自研的方式，更好的满足自身的业务需求与技术拓展。")]),t._v(" "),e("p",[t._v("🙂 另外，通过学习项目的 OAuth 2.0 实现，可以进一步加深对 OAuth 2.0 的理解，知其然、知其所以然！")])]),t._v(" "),e("p",[t._v("最终实现的整体架构，如下图所示：")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/OAuth2/%E5%AE%9E%E7%8E%B0%E6%9E%B6%E6%9E%84%E5%9B%BE.png",alt:"整体架构"}})]),t._v(" "),e("p",[t._v("详细的代码实现，我们在视频中进行讲解。")]),t._v(" "),e("h2",{attrs:{id:"如何实现-sso-单点登录"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#如何实现-sso-单点登录"}},[t._v("#")]),t._v(" 如何实现 SSO 单点登录？")]),t._v(" "),e("h3",{attrs:{id:"实战一-基于授权码模式-实现-sso-单点登录"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#实战一-基于授权码模式-实现-sso-单点登录"}},[t._v("#")]),t._v(" 实战一：基于授权码模式，实现 SSO 单点登录")]),t._v(" "),e("p",[t._v("示例代码见 "),e("a",{attrs:{href:"https://gitee.com/yudaocode/yudao-demo/tree/master/yudao-sso-demo-by-code",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://gitee.com/yudaocode/yudao-demo/tree/master/yudao-sso-demo-by-code"),e("OutboundLink")],1),t._v(" 地址，整体流程如下图所示：")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/OAuth2/%E6%8E%88%E6%9D%83%E7%A0%81%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95.png",alt:"整体流程"}})]),t._v(" "),e("p",[t._v("具体的使用流程如下：")]),t._v(" "),e("p",[e("strong",[t._v("① 第一步")]),t._v("，分别启动 "),e("code",[t._v("ruoyi-vue-pro")]),t._v(" 项目的前端和后端。")]),t._v(" "),e("p",[e("strong",[t._v("② 第二步")]),t._v("，访问 "),e("a",{attrs:{href:"http://127.0.0.1:1024/system/oauth2/oauth2/application",target:"_blank",rel:"noopener noreferrer"}},[t._v("系统管理 -> OAuth 2.0 -> 应用管理"),e("OutboundLink")],1),t._v(" 菜单，新增一个应用（客户端），信息如下图：")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/OAuth2/%E6%8E%88%E6%9D%83%E7%A0%81%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BF%A1%E6%81%AF.png",alt:"授权码模式的客户端信息"}})]),t._v(" "),e("ul",[e("li",[t._v("客户端编号："),e("code",[t._v("yudao-sso-demo-by-code")])]),t._v(" "),e("li",[t._v("客户端密钥："),e("code",[t._v("test")])]),t._v(" "),e("li",[t._v("应用名："),e("code",[t._v("基于授权码模式，如何实现 SSO 单点登录？")])]),t._v(" "),e("li",[t._v("授权类型："),e("code",[t._v("authorization_code")]),t._v("、"),e("code",[t._v("refresh_token")])]),t._v(" "),e("li",[t._v("授权范围："),e("code",[t._v("user.read")]),t._v("、"),e("code",[t._v("user.write")])]),t._v(" "),e("li",[t._v("可重定向的 URI 地址："),e("code",[t._v("http://127.0.0.1:18080")])])]),t._v(" "),e("p",[t._v("ps：如果已经有这个客户端，可以不用新增。")]),t._v(" "),e("p",[e("strong",[t._v("③ 第三步")]),t._v("，运行 "),e("a",{attrs:{href:"https://gitee.com/yudaocode/yudao-demo/blob/master/yudao-sso-demo-by-code/src/main/java/cn/iocoder/yudao/ssodemo/SSODemoApplication.java",target:"_blank",rel:"noopener noreferrer"}},[t._v("SSODemoApplication"),e("OutboundLink")],1),t._v(" 类，启动接入方的项目，它已经包含前端和后端部分。启动成功的日志如下：")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("友情提示：如果你使用的是 Vue3 + element-plus 的前端项目，一定要操作！！！")]),t._v(" "),e("p",[t._v("需要把 yudao-sso-demo-by-code 的 "),e("code",[t._v("index.html")]),t._v(" 文件中的 "),e("code",[t._v("http://127.0.0.1:1024")]),t._v(" 改成 "),e("code",[t._v("http://127.0.0.1:8080")]),t._v("！！！否则在后续的“授权回调”时，会跳转失败噢！！！")])]),t._v(" "),e("div",{staticClass:"language-Bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-10-01 "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(":24:35.572  INFO "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("60265")]),t._v(" --- "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("           main"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" o.s.b.w.embedded.tomcat.TomcatWebServer  "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" Tomcat started on port"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(": "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("18080")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" with context path "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n")])])]),e("p",[e("strong",[t._v("④ 第四步")]),t._v("，浏览器访问 "),e("a",{attrs:{href:"http://127.0.0.1:18080/index.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://127.0.0.1:18080/index.html"),e("OutboundLink")],1),t._v(" 地址，进入接入方的 index.html 首页。因为暂未登录，可以点击「跳转」按钮，跳转到 "),e("code",[t._v("ruoyi-vue-pro")]),t._v(" 项目的 SSO 单点登录页。")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/OAuth2/%E6%8E%88%E6%9D%83%E7%A0%81%E6%A8%A1%E5%BC%8F%E7%9A%84%E6%9C%AA%E7%99%BB%E5%BD%95%E9%A6%96%E9%A1%B5.png",alt:"授权码模式的未登录首页"}})]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("疑问：为什么没有跳转到 SSO 单点登录页，而是跳转到 ruoyi-vue-pro 项目的登录页？")]),t._v(" "),e("p",[t._v("因为在 "),e("code",[t._v("ruoyi-vue-pro")]),t._v(" 项目也未登录，所以先跳转到该项目的登录页，使用账号密码进行登录。登录完成后，会跳转回 SSO 单点登录页，继续完成 OAuth 2.0 的授权流程。")])]),t._v(" "),e("p",[e("strong",[t._v("⑤ 第五步")]),t._v('，勾选 "访问你的个人信息" 和 "修改你的个人信息"，点击「同意授权」按钮，完成 code 授权码的申请。')]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/OAuth2/%E6%8E%88%E6%9D%83%E7%A0%81%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%90%8C%E6%84%8F%E6%8E%88%E6%9D%83.png",alt:"同意授权"}})]),t._v(" "),e("p",[e("strong",[t._v("⑥ 第六步")]),t._v("，完成授权后，会跳转到接入方的 callback.html 回调页，并在 URL 上可以看到 code 授权码。")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/OAuth2/%E6%8E%88%E6%9D%83%E7%A0%81%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%9B%9E%E8%B0%83%E8%B7%B3%E8%BD%AC.png",alt:"授权码模式的回调跳转"}})]),t._v(" "),e("p",[e("strong",[t._v("⑦ 第七步")]),t._v("，点击「确认」按钮，接入方的前端会使用 code 授权码，向接入方的后端获取 accessToken 访问令牌。")]),t._v(" "),e("p",[t._v("而接入方的后端，使用接收到的 code 授权码，通过调用 "),e("code",[t._v("ruoyi-vue-pro")]),t._v(" 项目的后端，获取到 accessToken 访问令牌，并最终返回给接入方的前端。")]),t._v(" "),e("p",[e("strong",[t._v("⑧ 第八步")]),t._v("，在接入方的前端拿到 accessToken 访问令牌后，跳转回自己的 index.html 首页，并进一步从 "),e("code",[t._v("ruoyi-vue-pro")]),t._v(" 项目获取到该用户的昵称等个人信息。后续，你可以执行「修改昵称」、「刷新令牌」、「退出登录」等操作。")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/OAuth2/%E6%8E%88%E6%9D%83%E7%A0%81%E6%A8%A1%E5%BC%8F%E7%9A%84%E7%99%BB%E5%BD%95%E5%90%8E%E9%A6%96%E9%A1%B5.png",alt:"授权码模式的登录后首页"}})]),t._v(" "),e("hr"),t._v(" "),e("p",[t._v("示例代码的具体实现，与详细的解析，可以观看如下视频：")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://t.zsxq.com/06fUne6yZ",target:"_blank",rel:"noopener noreferrer"}},[t._v("02、基于授权码模式，如何实现 SSO 单点登录？"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://t.zsxq.com/06iuNRvjM",target:"_blank",rel:"noopener noreferrer"}},[t._v("03、请求时，如何校验 accessToken 访问令牌？"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://t.zsxq.com/06jAqFimu",target:"_blank",rel:"noopener noreferrer"}},[t._v("04、访问令牌过期时，如何刷新 Token 令牌？"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://t.zsxq.com/06ne6e6aE",target:"_blank",rel:"noopener noreferrer"}},[t._v("05、登录成功后，如何获得用户信息？"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://t.zsxq.com/06fUJIUfq",target:"_blank",rel:"noopener noreferrer"}},[t._v("06、退出时，如何删除 Token 令牌？"),e("OutboundLink")],1)])]),t._v(" "),e("h3",{attrs:{id:"实战二-基于密码模式-实现-sso-登录"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#实战二-基于密码模式-实现-sso-登录"}},[t._v("#")]),t._v(" 实战二：基于密码模式，实现 SSO 登录")]),t._v(" "),e("p",[t._v("示例代码见 "),e("a",{attrs:{href:"https://gitee.com/yudaocode/yudao-demo/tree/master/yudao-sso-demo-by-password",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://gitee.com/yudaocode/yudao-demo/tree/master/yudao-sso-demo-by-password"),e("OutboundLink")],1),t._v(" 地址，整体流程如下图所示：")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/OAuth2/%E5%AF%86%E7%A0%81%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95.png",alt:"整体流程"}})]),t._v(" "),e("p",[t._v("具体的使用流程如下：")]),t._v(" "),e("p",[e("strong",[t._v("① 第一步")]),t._v("，分别启动 "),e("code",[t._v("ruoyi-vue-pro")]),t._v(" 项目的前端和后端。")]),t._v(" "),e("p",[e("strong",[t._v("② 第二步")]),t._v("，访问 "),e("a",{attrs:{href:"http://127.0.0.1:1024/system/oauth2/oauth2/application",target:"_blank",rel:"noopener noreferrer"}},[t._v("系统管理 -> OAuth 2.0 -> 应用管理"),e("OutboundLink")],1),t._v(" 菜单，新增一个应用（客户端），信息如下图：")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/OAuth2/%E5%AF%86%E7%A0%81%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%BF%A1%E6%81%AF.png",alt:"密码模式的客户端信息"}})]),t._v(" "),e("ul",[e("li",[t._v("客户端编号："),e("code",[t._v("yudao-sso-demo-by-password")])]),t._v(" "),e("li",[t._v("客户端密钥："),e("code",[t._v("test")])]),t._v(" "),e("li",[t._v("应用名："),e("code",[t._v("基于密码模式，如何实现 SSO 单点登录？")])]),t._v(" "),e("li",[t._v("授权类型："),e("code",[t._v("password")]),t._v("、"),e("code",[t._v("refresh_token")])]),t._v(" "),e("li",[t._v("授权范围："),e("code",[t._v("user.read")]),t._v("、"),e("code",[t._v("user.write")])]),t._v(" "),e("li",[t._v("可重定向的 URI 地址："),e("code",[t._v("http://127.0.0.1:18080")])])]),t._v(" "),e("p",[t._v("ps：如果已经有这个客户端，可以不用新增。")]),t._v(" "),e("p",[e("strong",[t._v("③ 第三步")]),t._v("，运行 "),e("a",{attrs:{href:"https://gitee.com/yudaocode/yudao-demo/blob/master/yudao-sso-demo-by-password/src/main/java/cn/iocoder/yudao/ssodemo/SSODemoApplication.java",target:"_blank",rel:"noopener noreferrer"}},[t._v("SSODemoApplication"),e("OutboundLink")],1),t._v(" 类，启动接入方的项目，它已经包含前端和后端部分。启动成功的日志如下：")]),t._v(" "),e("div",{staticClass:"language-Bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token number"}},[t._v("2022")]),t._v("-10-04 "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(":24:35.572  INFO "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("60265")]),t._v(" --- "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("           main"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" o.s.b.w.embedded.tomcat.TomcatWebServer  "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" Tomcat started on port"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(": "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("18080")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("http"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" with context path "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n")])])]),e("p",[e("strong",[t._v("④ 第四步")]),t._v("，浏览器访问 "),e("a",{attrs:{href:"http://127.0.0.1:18080/index.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://127.0.0.1:18080/index.html"),e("OutboundLink")],1),t._v(" 地址，进入接入方的 index.html 首页。因为暂未登录，可以点击「跳转」按钮，跳转到 login.html 登录页。")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/OAuth2/%E5%AF%86%E7%A0%81%E6%A8%A1%E5%BC%8F%E7%9A%84%E6%9C%AA%E7%99%BB%E5%BD%95%E9%A6%96%E9%A1%B5.png",alt:"密码模式的未登录首页"}})]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/OAuth2/%E5%AF%86%E7%A0%81%E6%A8%A1%E5%BC%8F%E7%9A%84%E6%9C%AA%E7%99%BB%E5%BD%95%E9%A6%96%E9%A1%B52.png",alt:"密码模式的未登录首页2"}})]),t._v(" "),e("p",[e("strong",[t._v("⑤ 第五步")]),t._v("，点击「登录」按钮，调用 "),e("code",[t._v("ruoyi-vue-pro")]),t._v(" 项目的后端，获取到 accessToken 访问令牌，完成登录操作。")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/OAuth2/%E5%AF%86%E7%A0%81%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%8F%91%E8%B5%B7%E7%99%BB%E5%BD%95.png",alt:"密码模式的发起登录.png"}})]),t._v(" "),e("p",[e("strong",[t._v("⑥ 第六步")]),t._v("，登录完成后，跳转回自己的 index.html 首页，并进一步从 "),e("code",[t._v("ruoyi-vue-pro")]),t._v(" 项目获取到该用户的昵称等个人信息。后续，你可以执行「修改昵称」、「刷新令牌」、「退出登录」等操作。")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/OAuth2/%E5%AF%86%E7%A0%81%E6%A8%A1%E5%BC%8F%E7%9A%84%E7%99%BB%E5%BD%95%E5%90%8E%E9%A6%96%E9%A1%B5.png",alt:"密码模式的登录后首页"}})]),t._v(" "),e("hr"),t._v(" "),e("p",[t._v("示例代码的具体实现，与详细的解析，可以观看如下视频：")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://t.zsxq.com/06rrrzBAu",target:"_blank",rel:"noopener noreferrer"}},[t._v("07、基于密码模式，如何实现 SSO 单点登录？"),e("OutboundLink")],1)])]),t._v(" "),e("h2",{attrs:{id:"oauth-2-0-表结构"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#oauth-2-0-表结构"}},[t._v("#")]),t._v(" OAuth 2.0 表结构")]),t._v(" "),e("p",[e("img",{attrs:{src:"/img/OAuth2/%E8%A1%A8%E7%BB%93%E6%9E%84.png",alt:"表结构"}})]),t._v(" "),e("p",[t._v("每个表的具体设计，与详细的解析，可以观看如下视频：")]),t._v(" "),e("ul",[e("li",[e("a",{attrs:{href:"https://t.zsxq.com/06ubEmeII",target:"_blank",rel:"noopener noreferrer"}},[t._v("08、如何实现客户端的管理？"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://t.zsxq.com/06qjm2rbQ",target:"_blank",rel:"noopener noreferrer"}},[t._v("09、单点登录界面，如何进行初始化？"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://t.zsxq.com/06AEQfA2j",target:"_blank",rel:"noopener noreferrer"}},[t._v("10、单点登录界面，如何进行【手动】授权？"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://t.zsxq.com/06JIQvrrN",target:"_blank",rel:"noopener noreferrer"}},[t._v("11、单点登录界面，如何进行【自动】授权？"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://t.zsxq.com/06jEQZNfE",target:"_blank",rel:"noopener noreferrer"}},[t._v("12、基于【授权码】模式，如何获得 Token 令牌？"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://t.zsxq.com/06aEynUZF",target:"_blank",rel:"noopener noreferrer"}},[t._v("13、基于【密码】模式，如何获得 Token 令牌？"),e("OutboundLink")],1)]),t._v(" "),e("li",[e("a",{attrs:{href:"https://t.zsxq.com/06MbM3n2v",target:"_blank",rel:"noopener noreferrer"}},[t._v("14、如何校验、刷新、删除访问令牌？"),e("OutboundLink")],1)])])])}),[],!1,null,null,null);e.default=a.exports}}]);