(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{400:function(t,s,_){"use strict";_.r(s);var a=_(7),r=Object(a.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("相关视频：")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://t.zsxq.com/04iynUF6e",target:"_blank",rel:"noopener noreferrer"}},[t._v("05、如何实现流程模型的新建？"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://t.zsxq.com/04rNVbEQB",target:"_blank",rel:"noopener noreferrer"}},[t._v("06、如何实现流程模型的流程图的设计？"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://t.zsxq.com/042neybYz",target:"_blank",rel:"noopener noreferrer"}},[t._v("07、如何实现流程模型的流程图的预览？"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://t.zsxq.com/04jUBMjyF",target:"_blank",rel:"noopener noreferrer"}},[t._v("09、如何实现流程模型的发布？"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://t.zsxq.com/04MF6URvz",target:"_blank",rel:"noopener noreferrer"}},[t._v("10、如何实现流程定义的查询？"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://t.zsxq.com/04R72rzzN",target:"_blank",rel:"noopener noreferrer"}},[t._v("21、如何实现流程的流程图的高亮？"),s("OutboundLink")],1)])])]),t._v(" "),s("p",[t._v("在 "),s("RouterLink",{attrs:{to:"/bpm/use-bpm-form/"}},[t._v("《审批接入（流程表单）》")]),t._v("、"),s("RouterLink",{attrs:{to:"/bpm/use-business-form/"}},[t._v("《审批接入（业务表单）》")]),t._v(" 小节中，我们已经新建过流程模型，并发布为流程定义，如下图所示：")],1),t._v(" "),s("p",[s("img",{attrs:{src:"/img/%E5%B7%A5%E4%BD%9C%E6%B5%81%E6%89%8B%E5%86%8C/BPMN%E6%B5%81%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%99%A8/%E7%A4%BA%E4%BE%8B%E6%B5%81%E7%A8%8B.png",alt:"示例流程"}})]),t._v(" "),s("p",[t._v("本文，我们将进一步讲解【"),s("strong",[t._v("流程模型")]),t._v("】、【"),s("strong",[t._v("流程定义")]),t._v("】，特别是如何使用 BPMN 流程设计器。")]),t._v(" "),s("h2",{attrs:{id:"_1-流程模型"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-流程模型"}},[t._v("#")]),t._v(" 1. 流程模型")]),t._v(" "),s("p",[t._v("流程模型，对应 [工作流程 -> 流程管理 -> 流程模型] 菜单，如下图所示：")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/%E5%B7%A5%E4%BD%9C%E6%B5%81%E6%89%8B%E5%86%8C/%E5%8A%9F%E8%83%BD%E6%BC%94%E7%A4%BA/%E7%AE%A1%E7%90%86%E5%90%8E%E5%8F%B0.png",alt:"流程模型"}})]),t._v(" "),s("ul",[s("li",[t._v("后端，由 BpmModelController 提供接口")]),t._v(" "),s("li",[t._v("前端，由 "),s("code",[t._v("/views/bpm/model/index.vue")]),t._v(" 实现界面")])]),t._v(" "),s("h3",{attrs:{id:"_1-1-表结构"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-表结构"}},[t._v("#")]),t._v(" 1.1 表结构")]),t._v(" "),s("p",[t._v("流程设计模型部署表，由 Flowable 提供的 "),s("code",[t._v("ACT_RE_MODEL")]),t._v(" 表实现，如下所示：")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("字段名称")]),t._v(" "),s("th",[t._v("字段描述")]),t._v(" "),s("th",[t._v("数据类型")]),t._v(" "),s("th",[t._v("主键")]),t._v(" "),s("th",[t._v("为空")]),t._v(" "),s("th",[t._v("取值说明")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("ID_")]),t._v(" "),s("td",[t._v("ID_")]),t._v(" "),s("td",[t._v("nvarchar(64)")]),t._v(" "),s("td",[t._v("√")]),t._v(" "),s("td"),t._v(" "),s("td",[t._v("ID_")])]),t._v(" "),s("tr",[s("td",[t._v("REV_")]),t._v(" "),s("td",[t._v("乐观锁")]),t._v(" "),s("td",[t._v("int")]),t._v(" "),s("td"),t._v(" "),s("td",[t._v("√")]),t._v(" "),s("td",[t._v("乐观锁")])]),t._v(" "),s("tr",[s("td",[t._v("NAME_")]),t._v(" "),s("td",[t._v("名称")]),t._v(" "),s("td",[t._v("nvarchar(255)")]),t._v(" "),s("td"),t._v(" "),s("td",[t._v("√")]),t._v(" "),s("td",[t._v("名称")])]),t._v(" "),s("tr",[s("td",[t._v("KEY_")]),t._v(" "),s("td",[t._v("KEY_")]),t._v(" "),s("td",[t._v("nvarchar(255)")]),t._v(" "),s("td"),t._v(" "),s("td",[t._v("√")]),t._v(" "),s("td",[t._v("key")])]),t._v(" "),s("tr",[s("td",[t._v("CATEGORY_")]),t._v(" "),s("td",[t._v("分类")]),t._v(" "),s("td",[t._v("nvarchar(255)")]),t._v(" "),s("td"),t._v(" "),s("td",[t._v("√")]),t._v(" "),s("td",[t._v("分类")])]),t._v(" "),s("tr",[s("td",[t._v("CREATE_TIME_")]),t._v(" "),s("td",[t._v("创建时间")]),t._v(" "),s("td",[t._v("datetime")]),t._v(" "),s("td"),t._v(" "),s("td",[t._v("√")]),t._v(" "),s("td",[t._v("创建时间")])]),t._v(" "),s("tr",[s("td",[t._v("LAST_UPDATE_TIME_")]),t._v(" "),s("td",[t._v("最新修改时间")]),t._v(" "),s("td",[t._v("datetime")]),t._v(" "),s("td"),t._v(" "),s("td",[t._v("√")]),t._v(" "),s("td",[t._v("最新修改时间")])]),t._v(" "),s("tr",[s("td",[t._v("VERSION_")]),t._v(" "),s("td",[t._v("版本")]),t._v(" "),s("td",[t._v("int")]),t._v(" "),s("td"),t._v(" "),s("td",[t._v("√")]),t._v(" "),s("td",[t._v("版本")])]),t._v(" "),s("tr",[s("td",[t._v("META_INFO_")]),t._v(" "),s("td",[t._v("META_INFO_")]),t._v(" "),s("td",[t._v("nvarchar(255)")]),t._v(" "),s("td"),t._v(" "),s("td",[t._v("√")]),t._v(" "),s("td",[t._v("以 json 格式保存流程定义的信息")])]),t._v(" "),s("tr",[s("td",[t._v("DEPLOYMENT_ID_")]),t._v(" "),s("td",[t._v("部署ID")]),t._v(" "),s("td",[t._v("nvarchar(255)")]),t._v(" "),s("td"),t._v(" "),s("td",[t._v("√")]),t._v(" "),s("td",[t._v("部署ID")])]),t._v(" "),s("tr",[s("td",[t._v("EDITOR_SOURCE_VALUE_ID_")]),t._v(" "),s("td"),t._v(" "),s("td",[t._v("datetime")]),t._v(" "),s("td"),t._v(" "),s("td",[t._v("√")]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[t._v("EDITOR_SOURCE_EXTRA_VALUE_ID_")]),t._v(" "),s("td"),t._v(" "),s("td",[t._v("datetime")]),t._v(" "),s("td"),t._v(" "),s("td",[t._v("√")]),t._v(" "),s("td")])])]),t._v(" "),s("p",[t._v("我们可以通过 "),s("code",[t._v("META_INFO")]),t._v(" 字段，额外拓展了 "),s("code",[t._v("icon")]),t._v(" 图标、"),s("code",[t._v("description")]),t._v(" 描述、"),s("code",[t._v("formType")]),t._v("、"),s("code",[t._v("formId")]),t._v("、"),s("code",[t._v("formCustomCreatePath")]),t._v("、"),s("code",[t._v("formCustomViewPath")]),t._v(" 表单等信息。如下图所示：")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/%E5%B7%A5%E4%BD%9C%E6%B5%81%E6%89%8B%E5%86%8C/BPMN%E6%B5%81%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%99%A8/META_INFO.png",alt:"模型的拓展字段"}})]),t._v(" "),s("h3",{attrs:{id:"_1-2-流程设计器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-流程设计器"}},[t._v("#")]),t._v(" 1.2 流程设计器")]),t._v(" "),s("p",[t._v("① BPMN 流程设计器，由项目的 "),s("a",{attrs:{href:"https://github.com/yudaocode/yudao-ui-admin-vue3/blob/master/src/components/bpmnProcessDesigner/package/designer/ProcessDesigner.vue",target:"_blank",rel:"noopener noreferrer"}},[t._v("ProcessDesigner.vue"),s("OutboundLink")],1),t._v(" 实现。")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/%E5%B7%A5%E4%BD%9C%E6%B5%81%E6%89%8B%E5%86%8C/BPMN%E6%B5%81%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%99%A8/%E6%B5%81%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%99%A8.png",alt:"流程设计器"}})]),t._v(" "),s("p",[t._v("它是基于 "),s("a",{attrs:{href:"https://github.com/miyuesc/bpmn-process-designer",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/miyuesc/bpmn-process-designer"),s("OutboundLink")],1),t._v(" 拓展，底层是 "),s("a",{attrs:{href:"https://github.com/bpmn-io",target:"_blank",rel:"noopener noreferrer"}},[t._v("bpmn-js"),s("OutboundLink")],1),t._v("。")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("补充说明：")]),t._v(" "),s("p",[s("code",[t._v("bpmn-process-designer")]),t._v(" 提供 Vue2 + ElementUI、Vue3 + NaiveUI 两个版本，而我们是 Vue3 + ElementPlus，是通过 Vue2 + ElementUI 迁移适配实现。")])]),t._v(" "),s("p",[t._v("② BPMN 预览，支持高亮，由 "),s("a",{attrs:{href:"https://github.com/yudaocode/yudao-ui-admin-vue3/blob/master/src/components/bpmnProcessDesigner/package/designer/ProcessViewer.vue",target:"_blank",rel:"noopener noreferrer"}},[t._v("ProcessViewer.vue"),s("OutboundLink")],1),t._v(" 实现。")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/%E5%B7%A5%E4%BD%9C%E6%B5%81%E6%89%8B%E5%86%8C/BPMN%E6%B5%81%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%99%A8/%E6%B5%81%E7%A8%8B%E9%A2%84%E8%A7%88.png",alt:"流程预览"}})]),t._v(" "),s("p",[t._v("它是直接基于 "),s("a",{attrs:{href:"https://github.com/bpmn-io",target:"_blank",rel:"noopener noreferrer"}},[t._v("bpmn-js"),s("OutboundLink")],1),t._v(" 拓展，没有基于 "),s("code",[t._v("bpmn-process-designer")]),t._v("。")]),t._v(" "),s("hr"),t._v(" "),s("p",[t._v("下面，我们将详细讲解 BPMN 流程设计器的各个配置项：任务（表单）、任务（审批人）、多实例（会签配置）、执行监听器、任务监听器等等。")]),t._v(" "),s("h3",{attrs:{id:"_1-3-任务-表单"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-任务-表单"}},[t._v("#")]),t._v(" 1.3 任务（表单）")]),t._v(" "),s("h4",{attrs:{id:"_1-3-1-表单配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-1-表单配置"}},[t._v("#")]),t._v(" 1.3.1 表单配置")]),t._v(" "),s("p",[t._v("每个任务节点，有个 [表单] 配置项，用于配置任务审批时，补充填写表单信息。如下图所示：")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/%E5%B7%A5%E4%BD%9C%E6%B5%81%E6%89%8B%E5%86%8C/BPMN%E6%B5%81%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%99%A8/%E6%B5%81%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%99%A8%E7%9A%84%E8%A1%A8%E5%8D%95%E9%85%8D%E7%BD%AE.png",alt:"流程设计器的表单配置.png"}})]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("拓展知识：")]),t._v(" "),s("p",[t._v("① 问题：配置的表单，最终是怎么存储的？")]),t._v(" "),s("p",[t._v("回答：在 BPMN 的 UserTask 节点上，有个 "),s("code",[t._v("formKey")]),t._v(" 属性，用于存储表单的 key，这里我们就存了【流程表单】的编号。")]),t._v(" "),s("p",[t._v("② 问题：为什么只支持【流程表单】，不支持【业务表单】呢？")]),t._v(" "),s("p",[t._v("回答：【业务表单】暂时没想到比较优雅的二次修改方案，因为它属于业务系统，无法在审批通过时，一起进行提交。")]),t._v(" "),s("p",[t._v("③ 问题：表单设计器，怎么使用远程数据？")]),t._v(" "),s("p",[t._v("回答：参见 "),s("a",{attrs:{href:"https://docs.qq.com/doc/DZlNIVkZSTlVJVEd2",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docs.qq.com/doc/DZlNIVkZSTlVJVEd2"),s("OutboundLink")],1),t._v(" 文档。")])]),t._v(" "),s("h4",{attrs:{id:"_1-3-2-表单效果"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-2-表单效果"}},[t._v("#")]),t._v(" 1.3.2 表单效果")]),t._v(" "),s("p",[t._v("在审批任务通过时，需要额外填写表单信息，如下图所示：")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/%E5%B7%A5%E4%BD%9C%E6%B5%81%E6%89%8B%E5%86%8C/BPMN%E6%B5%81%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%99%A8/%E6%B5%81%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%99%A8%E7%9A%84%E8%A1%A8%E5%8D%95%E6%95%88%E6%9E%9C.png",alt:"流程设计器的表单效果.png"}})]),t._v(" "),s("p",[t._v("填写的表单数据，会存储到 Flowable 任务的 "),s("code",[t._v("variables")]),t._v(" 中，如下图所示：")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/%E5%B7%A5%E4%BD%9C%E6%B5%81%E6%89%8B%E5%86%8C/BPMN%E6%B5%81%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%99%A8/%E6%B5%81%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%99%A8%E7%9A%84%E8%A1%A8%E5%8D%95%E6%95%B0%E6%8D%AE.png",alt:"流程设计器的表单数据"}})]),t._v(" "),s("h3",{attrs:{id:"_1-4-任务-审批人"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-任务-审批人"}},[t._v("#")]),t._v(" 1.4 任务（审批人）")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/%E5%B7%A5%E4%BD%9C%E6%B5%81%E6%89%8B%E5%86%8C/%E9%80%89%E6%8B%A9%E5%AE%A1%E6%89%B9%E4%BA%BA/%E6%B5%81%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%99%A8%E7%9A%84%E5%AE%A1%E6%89%B9%E4%BA%BA%E9%85%8D%E7%BD%AE.png",alt:"流程设计器的审批人配置.png"}})]),t._v(" "),s("p",[t._v("详细见 "),s("RouterLink",{attrs:{to:"/bpm/assignee/"}},[t._v("《选择审批人、发起人自选》")]),t._v(" 文档。")],1),t._v(" "),s("h3",{attrs:{id:"_1-5-多实例-会签配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-5-多实例-会签配置"}},[t._v("#")]),t._v(" 1.5 多实例（会签配置）")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/%E5%B7%A5%E4%BD%9C%E6%B5%81%E6%89%8B%E5%86%8C/BPMN%E6%B5%81%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%99%A8/%E6%B5%81%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%99%A8%E7%9A%84%E4%BC%9A%E7%AD%BE%E9%85%8D%E7%BD%AE.png",alt:"流程设计器的会签配置"}})]),t._v(" "),s("p",[t._v("详细见 "),s("RouterLink",{attrs:{to:"/bpm/multi-instance/"}},[t._v("《会签、或签、依次审批》")]),t._v(" 文档。")],1),t._v(" "),s("h3",{attrs:{id:"_1-6-执行监听器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-6-执行监听器"}},[t._v("#")]),t._v(" 1.6 执行监听器")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/%E5%B7%A5%E4%BD%9C%E6%B5%81%E6%89%8B%E5%86%8C/%E6%B5%81%E7%A8%8B%E8%A1%A8%E8%BE%BE%E5%BC%8F/BpmTaskAssignStartUserExpressionConfig.png",alt:"BpmTaskAssignStartUserExpressionConfig"}})]),t._v(" "),s("p",[t._v("详细见 "),s("RouterLink",{attrs:{to:"/bpm/listener/"}},[t._v("《执行监听器、任务监听器》")]),t._v(" 文档。")],1),t._v(" "),s("h3",{attrs:{id:"_1-7-任务监听器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-7-任务监听器"}},[t._v("#")]),t._v(" 1.7 任务监听器")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/%E5%B7%A5%E4%BD%9C%E6%B5%81%E6%89%8B%E5%86%8C/%E7%9B%91%E5%90%AC%E5%99%A8/DemoDelegateClassTaskListenerConfig.png",alt:"配置监听器"}})]),t._v(" "),s("p",[t._v("详细见 "),s("RouterLink",{attrs:{to:"/bpm/listener/"}},[t._v("《执行监听器、任务监听器》")]),t._v(" 文档。")],1),t._v(" "),s("h2",{attrs:{id:"_2-流程定义"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-流程定义"}},[t._v("#")]),t._v(" 2. 流程定义")]),t._v(" "),s("p",[t._v("流程模型在部署后，会创建一个新版本的流程定义，并挂起老版本的流程定义。最终，我们点击某个流程模型的「流程定义」按钮，可以看到它对应的流程定义，如下图所示：")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/%E5%B7%A5%E4%BD%9C%E6%B5%81%E6%89%8B%E5%86%8C/BPMN%E6%B5%81%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%99%A8/%E6%B5%81%E7%A8%8B%E5%AE%9A%E4%B9%89.png",alt:"流程定义"}})]),t._v(" "),s("ul",[s("li",[t._v("后端，由 BpmProcessDefinitionController 提供接口")]),t._v(" "),s("li",[t._v("前端，由 "),s("a",{attrs:{href:"https://github.com/yudaocode/yudao-ui-admin-vue3",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("/views/bpm/definition/index.vue")]),s("OutboundLink")],1),t._v(" 实现界面")])]),t._v(" "),s("h3",{attrs:{id:"_2-1-表结构"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-表结构"}},[t._v("#")]),t._v(" 2.1 表结构")]),t._v(" "),s("p",[t._v("① 流程定义表，由 Flowable 提供的 "),s("code",[t._v("ACT_RE_PROCDEF")]),t._v(" 表实现，如下所示：")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("字段")]),t._v(" "),s("th",[t._v("类型")]),t._v(" "),s("th",[t._v("主键")]),t._v(" "),s("th",[t._v("说明")]),t._v(" "),s("th",[t._v("备注")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("ID_")]),t._v(" "),s("td",[t._v("NVARCHAR2(64)")]),t._v(" "),s("td",[t._v("Y")]),t._v(" "),s("td",[t._v("主键")]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[t._v("REV_")]),t._v(" "),s("td",[t._v("INTEGER")]),t._v(" "),s("td",[t._v("N")]),t._v(" "),s("td",[t._v("数据版本号")]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[t._v("CATEGORY_")]),t._v(" "),s("td",[t._v("NVARCHAR2(255)")]),t._v(" "),s("td",[t._v("N")]),t._v(" "),s("td",[t._v("流程定义分类")]),t._v(" "),s("td",[t._v("读取 xml 文件中程的 "),s("code",[t._v("targetNamespace")]),t._v(" 值")])]),t._v(" "),s("tr",[s("td",[t._v("NAME_")]),t._v(" "),s("td",[t._v("NVARCHAR2(255)")]),t._v(" "),s("td",[t._v("N")]),t._v(" "),s("td",[t._v("流程定义的名称")]),t._v(" "),s("td",[t._v("读取流程文件中 "),s("code",[t._v("process")]),t._v("元素的 "),s("code",[t._v("name")]),t._v(" 属性")])]),t._v(" "),s("tr",[s("td",[t._v("KEY_")]),t._v(" "),s("td",[t._v("NVARCHAR2(255)")]),t._v(" "),s("td",[t._v("N")]),t._v(" "),s("td",[t._v("流程定义key")]),t._v(" "),s("td",[t._v("读取流程文件中 "),s("code",[t._v("process")]),t._v(" 元素的 id 属性")])]),t._v(" "),s("tr",[s("td",[t._v("VERSION_")]),t._v(" "),s("td",[t._v("INTEGER")]),t._v(" "),s("td",[t._v("N")]),t._v(" "),s("td",[t._v("版本")]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[t._v("DEPLOYMENT_ID_")]),t._v(" "),s("td",[t._v("NVARCHAR2(64)")]),t._v(" "),s("td",[t._v("N")]),t._v(" "),s("td",[t._v("部署ID")]),t._v(" "),s("td",[t._v("流程定义对应的部署数据 ID")])]),t._v(" "),s("tr",[s("td",[t._v("RESOURCE_NAME_")]),t._v(" "),s("td",[t._v("NVARCHAR2(2000)")]),t._v(" "),s("td",[t._v("N")]),t._v(" "),s("td",[t._v("bpmn文件名称")]),t._v(" "),s("td",[t._v("一般为流程文件的相对路径")])]),t._v(" "),s("tr",[s("td",[t._v("DGRM_RESOURCE_NAME_")]),t._v(" "),s("td",[t._v("VARCHAR2(4000)")]),t._v(" "),s("td",[t._v("N")]),t._v(" "),s("td",[t._v("流程定义对应的流程图资源名称")]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[t._v("DESCRIPTION_")]),t._v(" "),s("td",[t._v("NVARCHAR2(2000)")]),t._v(" "),s("td",[t._v("N")]),t._v(" "),s("td",[t._v("说明")]),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[t._v("HAS_START_FORM_KEY_")]),t._v(" "),s("td",[t._v("NUMBER(1)")]),t._v(" "),s("td",[t._v("N")]),t._v(" "),s("td",[t._v("是否存在开始节点formKey")]),t._v(" "),s("td",[s("code",[t._v("start")]),t._v(" 节点是否存在 "),s("code",[t._v("formKey")]),t._v("：0-否，1-是")])]),t._v(" "),s("tr",[s("td",[t._v("HAS_GRAPHICAL_NOTATION_")]),t._v(" "),s("td",[t._v("NUMBER(1)")]),t._v(" "),s("td",[t._v("N")]),t._v(" "),s("td"),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[t._v("SUSPENSION_STATE_")]),t._v(" "),s("td",[t._v("INTEGER")]),t._v(" "),s("td",[t._v("N")]),t._v(" "),s("td",[t._v("流程定义状态")]),t._v(" "),s("td",[t._v("1-激活、2中止")])]),t._v(" "),s("tr",[s("td",[t._v("TENANT_ID_")]),t._v(" "),s("td",[t._v("NVARCHAR2(255)")]),t._v(" "),s("td",[t._v("N")]),t._v(" "),s("td"),t._v(" "),s("td")]),t._v(" "),s("tr",[s("td",[t._v("ENGINE_VERSION_")]),t._v(" "),s("td",[t._v("NVARCHAR2(255)")]),t._v(" "),s("td",[t._v("N")]),t._v(" "),s("td"),t._v(" "),s("td",[t._v("引擎版本")])])])]),t._v(" "),s("p",[t._v("② 由于 "),s("code",[t._v("ACT_RE_PROCDEF")]),t._v(" 表没有类似 "),s("code",[t._v("ACT_RE_MODEL")]),t._v(" 有 "),s("code",[t._v("META_INFO_")]),t._v(" 字段，所以我们额外创建了一个 BPM 流程定义的信息表，用于存储流程定义的额外信息。如下所示：")]),t._v(" "),s("blockquote",[s("p",[t._v("省略 creator/create_time/updater/update_time/deleted/tenant_id 等通用字段")])]),t._v(" "),s("div",{staticClass:"language-SQL extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("bpm_process_definition_info"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bigint")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AUTO_INCREMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'编号'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("process_definition_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHARACTER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" utf8mb4 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLLATE")]),t._v(" utf8mb4_unicode_ci "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'流程定义的编号'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("model_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHARACTER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" utf8mb4 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLLATE")]),t._v(" utf8mb4_unicode_ci "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'流程模型的编号'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("icon"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("512")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHARACTER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" utf8mb4 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLLATE")]),t._v(" utf8mb4_unicode_ci "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'图标'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("description"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("255")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHARACTER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" utf8mb4 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLLATE")]),t._v(" utf8mb4_unicode_ci "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'描述'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("form_type"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("tinyint")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'表单类型'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("form_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bigint")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'表单编号'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("form_conf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHARACTER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" utf8mb4 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLLATE")]),t._v(" utf8mb4_unicode_ci "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'表单的配置'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("form_fields"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHARACTER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" utf8mb4 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLLATE")]),t._v(" utf8mb4_unicode_ci "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'表单项的数组'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("form_custom_create_path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("255")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHARACTER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" utf8mb4 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLLATE")]),t._v(" utf8mb4_unicode_ci "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'自定义表单的提交路径'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("form_custom_view_path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("255")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHARACTER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" utf8mb4 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLLATE")]),t._v(" utf8mb4_unicode_ci "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'自定义表单的查看路径'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PRIMARY")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("KEY")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("USING")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BTREE")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENGINE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("InnoDB")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AUTO_INCREMENT")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("246")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHARSET")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("utf8mb4 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLLATE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("utf8mb4_unicode_ci "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'BPM 流程定义的信息表'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("本质上，就是把 "),s("code",[t._v("ACT_RE_MODEL")]),t._v(" 的 "),s("code",[t._v("META_INFO_")]),t._v(" 字段存储到 "),s("code",[t._v("bpm_process_definition_info")]),t._v(" 表中。")]),t._v(" "),s("p",[t._v("因此，最终每次流程模型在部署时，会往 Flowable 插入一条 "),s("code",[t._v("ACT_RE_PROCDEF")]),t._v(" 记录，也会往 "),s("code",[t._v("bpm_process_definition_info")]),t._v(" 表中插入一条记录。")]),t._v(" "),s("h3",{attrs:{id:"_2-2-流程定义列表-可发起流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-流程定义列表-可发起流程"}},[t._v("#")]),t._v(" 2.2 流程定义列表（可发起流程）")]),t._v(" "),s("p",[t._v("注意！一个流程模型，有且仅有一个【激活】状态的流程定义。最终，用户发起流程时，选择的是【激活】状态的流程定义。如下图所示：")]),t._v(" "),s("p",[s("img",{attrs:{src:"/img/%E5%B7%A5%E4%BD%9C%E6%B5%81%E6%89%8B%E5%86%8C/BPMN%E6%B5%81%E7%A8%8B%E8%AE%BE%E8%AE%A1%E5%99%A8/%E6%BF%80%E6%B4%BB%E7%9A%84%E6%B5%81%E7%A8%8B%E5%AE%9A%E4%B9%89.png",alt:"激活的流程定义"}})])])}),[],!1,null,null,null);s.default=r.exports}}]);