(window.webpackJsonp=window.webpackJsonp||[]).push([[146],{475:function(t,a,s){"use strict";s.r(a);var e=s(7),r=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[t._v("AI 思维导图，基于 LLM 大模型，实现智能思维导图的功能。")]),t._v(" "),a("p",[t._v("它的实现原理，是根据 prompt 提示词生成 markdown 内容，之后再通过 markdown 转换成思维导图。")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/AI%E6%89%8B%E5%86%8C/AI%E5%AF%BC%E5%9B%BE/%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE.png",alt:"思维导图"}})]),t._v(" "),a("p",[t._v("整个功能，涉及到 2 个表：")]),t._v(" "),a("ul",[a("li",[t._v("【配置】"),a("code",[t._v("ai_api_key")]),t._v("：API 秘钥表")]),t._v(" "),a("li",[t._v("【导图】"),a("code",[t._v("ai_mind_map")]),t._v("：思维导图记录表")])]),t._v(" "),a("p",[t._v("下面，我们逐个表进行介绍，这个过程中也会讲讲对应的功能。")]),t._v(" "),a("blockquote",[a("p",[t._v("省略 creator/create_time/updater/update_time/deleted/tenant_id 等通用字段")])]),t._v(" "),a("h2",{attrs:{id:"_1-api-秘钥表"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-api-秘钥表"}},[t._v("#")]),t._v(" 1. API 秘钥表")]),t._v(" "),a("p",[t._v("在 "),a("RouterLink",{attrs:{to:"/ai/chat/"}},[t._v("《AI 对话》")]),t._v(" 中，我们已经介绍了 API 秘钥表，这里就不再赘述了。")],1),t._v(" "),a("p",[t._v("你想使用哪个模型生成思维导图，可以参考对应的文档，进行配置：")]),t._v(" "),a("ul",[a("li",[t._v("国内模型："),a("a",{attrs:{href:"/ai/tongyi"}},[t._v("《通义千问》")]),t._v("、"),a("a",{attrs:{href:"/ai/deep-seek"}},[t._v("《DeepSeek》")]),t._v("、"),a("a",{attrs:{href:"/ai/doubao"}},[t._v("《豆包》")]),t._v("、"),a("a",{attrs:{href:"/ai/hunyuan"}},[t._v("《混元》")]),t._v("、"),a("a",{attrs:{href:"/ai/yiyan"}},[t._v("《文心一言》")]),t._v("、"),a("a",{attrs:{href:"/ai/siliconflow"}},[t._v("《硅基流动》")]),t._v("、"),a("a",{attrs:{href:"/ai/xinghuo"}},[t._v("《讯飞星火》")]),t._v("、"),a("a",{attrs:{href:"/ai/glm"}},[t._v("《智谱 GLM》")]),t._v("、"),a("a",{attrs:{href:"/ai/moonshot"}},[t._v("《月之暗灭》")]),t._v("、"),a("a",{attrs:{href:"/ai/minimax"}},[t._v("《MiniMax》")]),t._v("、"),a("a",{attrs:{href:"/ai/baichuan"}},[t._v("《百川智能》")])]),t._v(" "),a("li",[t._v("国外模型："),a("a",{attrs:{href:"/ai/openai"}},[t._v("《OpenAI（ChatGPT）》")]),t._v("、"),a("a",{attrs:{href:"/ai/llama"}},[t._v("《LLAMA》")]),t._v("、"),a("a",{attrs:{href:"/ai/azure-openai"}},[t._v("《【微软 OpenAI】ChatGPT》")]),t._v(" 、"),a("a",{attrs:{href:"/ai/gemini"}},[t._v("《谷歌 Gemini》")])])]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("友情提示：")]),t._v(" "),a("p",[t._v("一般情况下，建议先使用 "),a("a",{attrs:{href:"/ai/deep-seek"}},[t._v("《DeepSeek》")]),t._v(" 模型，因为免费送了一些 tokens，可以先体验一下。")])]),t._v(" "),a("h3",{attrs:{id:"_1-1-补充说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-补充说明"}},[t._v("#")]),t._v(" 1.1 补充说明")]),t._v(" "),a("p",[t._v("AI 生成思维导图时，使用什么模型和 system prompt 呢？它分成两种情况：")]),t._v(" "),a("p",[t._v("① 情况一：通过【聊天角色】中的“导图助手 ”进行配置。如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/AI%E6%89%8B%E5%86%8C/AI%E5%AF%BC%E5%9B%BE/%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE%E6%A8%A1%E5%9E%8B.png",alt:"AI 思维导图模型"}})]),t._v(" "),a("p",[t._v("② 情况二：如果没有配置，那就会使用 "),a("code",[t._v("ai_model")]),t._v(" 表中的第一个模型（排序 "),a("code",[t._v("sort")]),t._v(" 最小的）。同时，它对应的 system prompt 在 AiChatRoleEnum 的 "),a("code",[t._v("AI_MIND_MAP_ROLE")]),t._v(" 进行配置。")]),t._v(" "),a("h2",{attrs:{id:"_2-思维导图记录表"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-思维导图记录表"}},[t._v("#")]),t._v(" 2. 思维导图记录表")]),t._v(" "),a("p",[t._v("思维导图记录表，用户每发起一次思维导图，都会记录一条记录。")]),t._v(" "),a("h3",{attrs:{id:"_2-1-表结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-表结构"}},[t._v("#")]),t._v(" 2.1 表结构")]),t._v(" "),a("div",{staticClass:"language-SQL extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CREATE")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("TABLE")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("ai_mind_map"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bigint")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AUTO_INCREMENT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'编号'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("user_id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("bigint")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'用户编号'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  \n  "),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("platform"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("64")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHARACTER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" utf8mb4 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLLATE")]),t._v(" utf8mb4_unicode_ci "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'平台'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("model"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHARACTER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SET")]),t._v(" utf8mb4 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLLATE")]),t._v(" utf8mb4_unicode_ci "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'模型'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  \n  "),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("prompt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("text")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLLATE")]),t._v(" utf8mb4_unicode_ci "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("NOT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'生成内容提示'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("generated_content"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("text")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLLATE")]),t._v(" utf8mb4_unicode_ci "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'生成的思维导图内容'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   \n   "),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("error_message"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("varchar")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLLATE")]),t._v(" utf8mb4_unicode_ci "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("NULL")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'错误信息'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("PRIMARY")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("KEY")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token identifier"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ENGINE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("InnoDB")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AUTO_INCREMENT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DEFAULT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("CHARSET")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("utf8mb4 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COLLATE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("utf8mb4_unicode_ci "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("COMMENT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'AI 思维导图表'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("① "),a("code",[t._v("user_id")]),t._v(" 字段：对应 "),a("code",[t._v("system_users")]),t._v(" 表的 "),a("code",[t._v("id")]),t._v(" 字段，表示哪个用户生成的思维导图。")]),t._v(" "),a("p",[t._v("② "),a("code",[t._v("platform")]),t._v(" 字段：表示平台，对应 AiPlatformEnum 枚举，目前支持多个 AI 大模型。")]),t._v(" "),a("p",[a("code",[t._v("model")]),t._v(" 字段：表示模型标识，对应不同的平台的模型标识，例如说 OpenAI 的 "),a("code",[t._v("gpt-3.5-turbo")]),t._v("、"),a("code",[t._v("gpt-4-turbo")]),t._v("，通义千问的 "),a("code",[t._v("qwen-plus")]),t._v("、"),a("code",[t._v("qwen-max")]),t._v(" 等等。")]),t._v(" "),a("p",[t._v("③ "),a("code",[t._v("prompt")]),t._v(" 字段：表示生成内容提示，即生成思维导图的提示词。")]),t._v(" "),a("p",[a("code",[t._v("generated_content")]),t._v(" 字段：表示生成的思维导图内容，markdown 格式。")]),t._v(" "),a("p",[t._v("④ "),a("code",[t._v("error_message")]),t._v(" 字段：表示错误信息，如果生成失败，会记录错误信息。")]),t._v(" "),a("h3",{attrs:{id:"_2-2-管理后台"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-管理后台"}},[t._v("#")]),t._v(" 2.2 管理后台")]),t._v(" "),a("p",[t._v("① 前端对应 [AI 大模型 -> AI 思维导图] 菜单，对应 "),a("code",[t._v("yudao-ui-admin-vue3")]),t._v(" 项目的 "),a("code",[t._v("@/views/ai/mindmap/index")]),t._v(" 目录，提供给普通用户使用，生成思维导图。")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/AI%E6%89%8B%E5%86%8C/AI%E5%AF%BC%E5%9B%BE/%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE.png",alt:"思维导图"}})]),t._v(" "),a("p",[t._v("它的后端 HTTP 接口，由 "),a("code",[t._v("yudao-module-ai")]),t._v(" 模块的 "),a("code",[t._v("mindmap")]),t._v(" 包的 AiMindMapController 实现。")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("最最最关键的代码！！！大家可以重点看看！！！")]),t._v(" "),a("p",[t._v("AiMindMapController 提供的 "),a("code",[t._v("#generateMindMap(...)")]),t._v(" 生成思维导图接口。")]),t._v(" "),a("p",[t._v("它的内部，调用 Spring AI 的 StreamingChatClient 来实现大模型的调用。")])]),t._v(" "),a("p",[t._v("② 前端对应 [AI 大模型 -> 控制台 -> 导图管理] 菜单，对应 "),a("code",[t._v("yudao-ui-admin-vue3")]),t._v(" 项目的 "),a("code",[t._v("@/views/ai/mindmap/mananger")]),t._v(" 目录，提供给管理员使用，查看思维导图记录。")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/AI%E6%89%8B%E5%86%8C/AI%E5%AF%BC%E5%9B%BE/%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE%E7%AE%A1%E7%90%86.png",alt:"思维导图管理"}})])])}),[],!1,null,null,null);a.default=r.exports}}]);